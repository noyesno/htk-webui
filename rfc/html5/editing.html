<!DOCTYPE html><html lang="en-US-x-Hixie"><meta charset="utf-8"><title>7 User interaction — HTML5</title><script src="link-fixup.js"></script><style type="text/css">

     .applies thead th > * { display: block; }
     .applies thead code { display: block; }
     .applies tbody th { white-space: nowrap; }
     .applies td { text-align: center; }
     .applies .yes { background: yellow; }

     .matrix, .matrix td { border: hidden; text-align: right; }
     .matrix { margin-left: 2em; }

     .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
     .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
     .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

     td.eg { border-width: thin; text-align: center; }

     #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
     #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
     #table-example-1 caption { padding-bottom: 0.5em; }
     #table-example-1 thead, #table-example-1 tbody { border: none; }
     #table-example-1 th, #table-example-1 td { border: solid thin; }
     #table-example-1 th { font-weight: normal; }
     #table-example-1 td { border-style: none solid; vertical-align: top; }
     #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
     #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
     #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
     #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
     #table-example-1 tbody td:first-child::after { content: leader(". "); }
     #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
     #table-example-1 tbody td:first-child + td { width: 10em; }
     #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
     #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

     .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
     .apple-table-examples * { font-family: "Times", serif; }
     .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
     .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
     .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
     .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
     .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
     .apple-table-examples td { text-align: right; vertical-align: top; }
     .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
     .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
     .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
     .apple-table-examples sup { line-height: 0; }

     .details-example img { vertical-align: top; }

     #base64-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 6em;
       column-count: 5;
       column-gap: 1em;
       -moz-column-width: 6em;
       -moz-column-count: 5;
       -moz-column-gap: 1em;
       -webkit-column-width: 6em;
       -webkit-column-count: 5;
       -webkit-column-gap: 1em;
     }
     #base64-table thead { display: none; }
     #base64-table * { border: none; }
     #base64-table tbody td:first-child:after { content: ':'; }
     #base64-table tbody td:last-child { text-align: right; }

     #named-character-references-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 30em;
       column-gap: 1em;
       -moz-column-width: 30em;
       -moz-column-gap: 1em;
       -webkit-column-width: 30em;
       -webkit-column-gap: 1em;
     }
     #named-character-references-table > table > tbody > tr > td:first-child + td,
     #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
     #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
     #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

     .glyph.control { color: red; }

     @font-face {
       font-family: 'Essays1743';
       src: url('http://www.w3.org/TR/html5/fonts/Essays1743.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-weight: bold;
       src: url('http://www.w3.org/TR/html5/fonts/Essays1743-Bold.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       src: url('fonts/Essays1743-Italic.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       font-weight: bold;
       src: url('fonts/Essays1743-BoldItalic.ttf');
     }

    </style><style type="text/css">
       pre { margin-left: 2em; white-space: pre-wrap; }
       h2 { margin: 3em 0 1em 0; }
       h3 { margin: 2.5em 0 1em 0; }
       h4 { margin: 2.5em 0 0.75em 0; }
       h5, h6 { margin: 2.5em 0 1em; }
       h1 + h2, h1 + h2 + h2, h1 + p, h1 + p + h2 { margin: 0.75em 0 0.75em; }
       h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 0.5em; }
       p { margin: 1em 0; }
       hr:not(.top) { display: block; background: none; border: none; padding: 0; margin: 2em 0; height: auto; }
       .element dd,  .element dl { margin-top: 0em; margin-bottom: 0.25em;}
       dt { margin-top: 0.75em; margin-bottom: 0.5em; clear: left; }
        .element dt { margin-top: 0.5em; margin-bottom: 0.5em;  }
       adding tag omission & allowed ARIA role, state and property info to element definitions in HTML5.1 http://www.w3.org/html/wg/drafts/html/master/semantics.html#the-html-element … feedabck welcome!
       dt + dt { margin-top: 0; }
       dd dt { margin-top: 0.25em; margin-bottom: 0; }
       dd p { margin-top: 0; }
       dd dl + p { margin-top: 1em; }
       dd table + p { margin-top: 1em; }
       p + * > li, dd li { margin: 1em 0; }
       dt, dfn { font-weight: bold; font-style: normal; }
       i, em { font-style: italic; }
       dt dfn { font-style: italic; }
       pre, code { font-size: inherit; font-family: monospace; font-variant: normal; }
       pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
       pre em { font-weight: bolder; font-style: normal; }
       @media screen { code { color: #D93B00; } code :link, code :visited { color: inherit; } }
       var { background-color: #f9f9f9; border: 1px solid #eee; padding: 0 2px; }
       var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
       table { border-collapse: collapse; border-style: hidden hidden none hidden; }
       table thead, table tbody { border-bottom: solid; }
       table tbody th:first-child { border-left: solid; }
       table tbody th { text-align: left; }
       table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
       blockquote { margin: 0 0 0 2em; border: 0; padding: 0; font-style: italic; }

       .bad, .bad *:not(.XXX) { color: #5F6D7A; border-color: gray; background: transparent; }
       .matrix, .matrix td { border: none; text-align: right; }
       .matrix { margin-left: 2em; }
       .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
       .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
       .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

       .toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
       img.extra, p.overview { float: right; }
       pre.idl { border: solid thin #d3d3d3; background: #FCFCFC; color: black; padding: 0.5em 1em; position: relative; }
       pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
       pre.idl::before { content: "IDL"; font: bold small sans-serif; padding: 0.5em; background: white; position: absolute; top: 0; margin: -1px 0 0 -4em; width: 1.5em; border: thin solid; border-radius: 0 0 0 0.5em }
       pre.css { border: solid thin; background: #FFFFEE; color: black; padding: 0.5em 1em; }
       pre.css:first-line { color: #AAAA50; }
       dl.domintro {padding: 0.5em 1em; border: none; background:#E9FBE9; border: 1px solid lightgray; }
       hr + dl.domintro, div.impl + dl.domintro { margin-top: 2.5em; margin-bottom: 1.5em; }
       dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
       dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
       dl.domintro dd p { margin: 0.5em 0; }
       dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This definition is non-normative. Implementation requirements are given below this definition.'; color: #606060; border:1px solid lightgray; background: white; padding: 0 0.25em;font-size:.9em;}
       dl.switch { padding-left: 2em; }
       dl.switch > dt { text-indent: -1.5em; }
       dl.switch > dt:before { content: '\21AA'; padding: 0 0.5em 0 0; display: inline-block; width: 1em; text-align: right; line-height: 0.5em; }
       dl.triple { padding: 0 0 0 1em; }
       dl.triple dt, dl.triple dd { margin: 0; display: inline }
       dl.triple dt:after { content: ':'; }
       dl.triple dd:after { content: '\A'; white-space: pre; }
       .diff-old { text-decoration: line-through; color: silver; background: transparent; }
       .diff-chg, .diff-new { text-decoration: underline; color: green; background: transparent; }
       a .diff-new { border-bottom: 1px blue solid; }

       figure.diagrams { border: double black; background: white; padding: 1em; }
       figure.diagrams img { display: block; margin: 1em auto; } 

       h2 { page-break-before: always; }
       h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
       h1 + h2, hr + h2.no-toc { page-break-before: auto; }

       p  > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]),
       li > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]) { border-bottom: solid #9999CC; }

       div.head { margin: 0 0 1em; padding: 1em 0 0 0; }
       div.head p { margin: 0; }
       div.head h1 { margin: 0; }
       div.head .logo { float: right; margin: 0 1em; }
       div.head .logo img { border: none } /* remove border from top image */
       div.head dl { margin: 1em 0; }
       div.head p.copyright, div.head p.alt { font-size: x-small; font-style: oblique; margin: 0; }

       body > .toc > li { margin-top: 1em; margin-bottom: 1em; }
       body > .toc.brief > li { margin-top: 0.35em; margin-bottom: 0.35em; }
       body > .toc > li > * { margin-bottom: 0.5em; }
       body > .toc > li > * > li > * { margin-bottom: 0.25em; }
       .toc, .toc li { list-style: none; }

       .brief { margin-top: 1em; margin-bottom: 1em; line-height: 1.1; }
       .brief li { margin: 0; padding: 0; }
       .brief li p { margin: 0; padding: 0; }

       .category-list { margin-top: -0.75em; margin-bottom: 1em; line-height: 1.5; }
       .category-list::before { content: '\21D2\A0'; font-size: 1.2em; font-weight: 900; }
       .category-list li { display: inline; }
       .category-list li:not(:last-child)::after { content: ', '; }
       .category-list li > span, .category-list li > a { text-transform: lowercase; }
       .category-list li * { text-transform: none; } /* don't affect <code> nested in <a> */

       .XXX { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
       .XXX > :first-child { margin-top: 0; }
       p .XXX { line-height: 3em; }
       .annotation { border: solid thin black; background: #0C479D; color: white; position: relative; margin: 8px 0 20px 0; }
       .annotation:before { position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 6px -6px -6px 6px; background: #333333; z-index: -1; content: ''; }
       .annotation :link, .annotation :visited { color: inherit; }
       .annotation :link:hover, .annotation :visited:hover { background: transparent; }
       .annotation span { border: none ! important; }
       .note { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
       .warning { background-color: #F9F0D4; border: medium double #FF0000; margin: 1em; padding: 1em; }
       .note em, .warning em, .note i, .warning i { font-style: normal; }
       p.note, div.note { padding: 0.5em 2em; }
       span.note { padding: 0 2em; }
       .note p:first-child, .warning p:first-child { margin-top: 0; }
       .note p:last-child, .warning p:last-child { margin-bottom: 0; }
       .warning:before { font-style: normal; }
       p.note:before { content: 'Note: '; font-weight: bolder;}
       p.warning:before { content: '\26A0 Warning! '; font-weight:bolder;}
       .critical {margin:1em; border:double red; padding:1em; background-color:#F9F0D4;}

       .bookkeeping:before { display: block; content: 'Bookkeeping details'; font-weight: bolder; font-style: italic; }
       .bookkeeping { font-size: 0.8em; margin: 2em 0; }
       .bookkeeping p { margin: 0.5em 2em; display: list-item; list-style: square; }
       .bookkeeping dt { margin: 0.5em 2em 0; }
       .bookkeeping dd { margin: 0 3em 0.5em; }

       h4 { position: relative; z-index: 3; }
       h4 + .element, h4 + div + .element { margin-top: -2.5em; padding-top: 2em; }
       .element {
         background: #F4F4FA;
         color: black;
         margin: 0 0 1em 0.15em;
         padding: 0 1em 0.25em 0.75em;
         border-left: solid #9999FF 0.25em;
         position: relative;
         z-index: 1;
       }
       .element:before {
         position: absolute;
         z-index: 2;
         top: 0;
         left: -1.15em;
         height: 2em;
         width: 0.9em;
         background: #F4F4FA;
         content: ' ';
         border-style: none none solid solid;
         border-color: #9999FF;
         border-width: 0.25em;
       }

       .example { display: block; color: #222222; background: #FCFCFC; border-left-style: solid;border-color:#c0c0c0; border-left-width: 0.25em; margin-left: 1em; padding-left: 1em;padding-bottom: 0.5em;}
       div.example:before { content: 'Code Example: '; font-weight: bolder;}
       td > .example:only-child { margin: 0 0 0 0.1em; }

       ul.domTree, ul.domTree ul { padding: 0 0 0 1em; margin: 0; }
       ul.domTree li { padding: 0; margin: 0; list-style: none; position: relative; }
       ul.domTree li li { list-style: none; }
       ul.domTree li:first-child::before { position: absolute; top: 0; height: 0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree li:not(:last-child)::after { position: absolute; top: 0; bottom: -0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree span { font-style: italic; font-family: serif; }
       ul.domTree .t1 code { color: purple; font-weight: bold; }
       ul.domTree .t2 { font-style: normal; font-family: monospace; }
       ul.domTree .t2 .name { color: black; font-weight: bold; }
       ul.domTree .t2 .value { color: blue; font-weight: normal; }
       ul.domTree .t3 code, .domTree .t4 code, .domTree .t5 code { color: gray; }
       ul.domTree .t7 code, .domTree .t8 code { color: green; }
       ul.domTree .t10 code { color: teal; }

       body.dfnEnabled dfn { cursor: pointer; }
       .dfnPanel {
         display: inline;
         position: absolute;
         z-index: 10;
         height: auto;
         width: auto;
         padding: 0.5em 0.75em;
         font: small sans-serif, Droid Sans Fallback;
         background: #DDDDDD;
         color: black;
         border: outset 0.2em;
       }
       .dfnPanel * { margin: 0; padding: 0; font: inherit; text-indent: 0; }
       .dfnPanel :link, .dfnPanel :visited { color: black; }
       .dfnPanel p { font-weight: bolder; }
       .dfnPanel * + p { margin-top: 0.25em; }
       .dfnPanel li { list-style-position: inside; }

       #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
       #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
       #configUI p label { display: block; }
       #configUI #updateUI, #configUI .loginUI { text-align: center; }
       #configUI input[type=button] { display: block; margin: auto; }

       fieldset { margin: 1em; padding: 0.5em 1em; }
       fieldset > legend + * { margin-top: 0; }
       fieldset > :last-child { margin-bottom: 0; }
       fieldset p { margin: 0.5em 0; }
       header p.subline {color:#005A9C; font: 140% sans-serif;margin: 0.75em 0;}
       #authorButton {overflow: visible; padding: 0.1em 0.3em; position: fixed; right: 2em; top: 6em; width: auto;}

       @media print {#authorButton { display:none;}}

   .stability {
     position: fixed;
     bottom: 0;
     left: 0; right: 0;
     margin: 0 auto 0 auto;
     width: 50%;
     background: maroon; color: yellow;
     -webkit-border-radius: 1em 1em 0 0;
     -moz-border-radius: 1em 1em 0 0;
     border-radius: 1em 1em 0 0;
     -moz-box-shadow: 0 0 1em #500;
     -webkit-box-shadow: 0 0 1em #500;
     box-shadow: 0 0 1em red;
     padding: 0.5em 1em;
     text-align: center;
   }
   .stability strong {
     display: block;
   }
   .stability input {
     -moz-appearance: none; -webkit-appearance: none; margin: 0; 
     border: 0; padding: 0.25em 0.5em; background: transparent; color: black;
     position: absolute; top: -0.5em; right: 0; font: 1.25em sans-serif; text-align: center;
   }
   .stability input:hover {
     color: white;
     text-shadow: 0 0 2px black;
   }
   .stability input:active {
     padding: 0.3em 0.45em 0.2em 0.55em;
   }
   .stability :link, .stability :visited,
   .stability :link:hover, .stability :visited:hover {
     background: transparent;
     color: white;
   }

  </style><link href="http://www.w3.org/StyleSheets/TR/W3C-CR" rel="stylesheet" type="text/css"><script>
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
  </script><!-- style switcher script by Stommepoes  --><link href="switcher/author-view.css" id="author-view" rel="alternate stylesheet" title="Author documentation only"><script src="switcher/authorstylesheet.js"></script><link href="webappapis.html" rel="prev" title="6 Web application APIs">
  <link href="Overview.html#contents" rel="contents" title="Table of contents">
  <link href="syntax.html" rel="next" title="8 The HTML syntax">
  <body class="split chapter" onload="fixBrokenLink();"><div class="head" id="head">
<header><span id="styleSwitch"></span>
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>

    <h1 id="big-title">HTML5</h1>
    <p class="no-num no-toc subline">A vocabulary and associated APIs for HTML and XHTML</p>
   <h2 class="no-num no-toc" id="w3c-candidate-recommendation-29-april-2014">W3C Candidate Recommendation 29 April 2014</h2>
   </header></div>
  

  <nav class="prev_next">
   <a href="webappapis.html">← 6 Web application APIs</a> –
   <a href="Overview.html#contents">Table of contents</a> –
   <a href="syntax.html">8 The HTML syntax →</a>
  <ol class="toc"><li><a href="editing.html#editing"><span class="secno">7 </span>User interaction</a>
  <ol><li><a href="editing.html#the-hidden-attribute"><span class="secno">7.1 </span>The <code>hidden</code> attribute</a><li><a href="editing.html#inert-subtrees"><span class="secno">7.2 </span>Inert subtrees</a><li><a href="editing.html#activation"><span class="secno">7.3 </span>Activation</a><li><a href="editing.html#focus"><span class="secno">7.4 </span>Focus</a>
    <ol><li><a href="editing.html#sequential-focus-navigation-and-the-tabindex-attribute"><span class="secno">7.4.1 </span>Sequential focus navigation and the <code data-anolis-xref="attr-tabindex">tabindex</code> attribute</a><li><a href="editing.html#focus-management"><span class="secno">7.4.2 </span>Focus management</a><li><a href="editing.html#document-level-focus-apis"><span class="secno">7.4.3 </span>Document-level focus APIs</a><li><a href="editing.html#element-level-focus-apis"><span class="secno">7.4.4 </span>Element-level focus APIs</a></ol><li><a href="editing.html#assigning-keyboard-shortcuts"><span class="secno">7.5 </span>Assigning keyboard shortcuts</a>
    <ol><li><a href="editing.html#introduction-5"><span class="secno">7.5.1 </span>Introduction</a><li><a href="editing.html#the-accesskey-attribute"><span class="secno">7.5.2 </span>The <code>accesskey</code> attribute</a><li><a href="editing.html#processing-model-4"><span class="secno">7.5.3 </span>Processing model</a></ol><li><a href="editing.html#editing-0"><span class="secno">7.6 </span>Editing</a>
    <ol><li><a href="editing.html#contenteditable"><span class="secno">7.6.1 </span>Making document regions editable: The <code data-anolis-xref="attr-contenteditable">contenteditable</code> content attribute</a><li><a href="editing.html#making-entire-documents-editable:-the-designmode-idl-attribute"><span class="secno">7.6.2 </span>Making entire documents editable: The <code data-anolis-xref="dom-document-designMode">designMode</code> IDL attribute</a><li><a href="editing.html#best-practices-for-in-page-editors"><span class="secno">7.6.3 </span>Best practices for in-page editors</a><li><a href="editing.html#editing-apis"><span class="secno">7.6.4 </span>Editing APIs</a><li><a href="editing.html#spelling-and-grammar-checking"><span class="secno">7.6.5 </span>Spelling and grammar checking</a></ol><li><a href="editing.html#dnd"><span class="secno">7.7 </span>Drag and drop</a>
    <ol><li><a href="editing.html#introduction-6"><span class="secno">7.7.1 </span>Introduction</a><li><a href="editing.html#the-drag-data-store"><span class="secno">7.7.2 </span>The drag data store</a><li><a href="editing.html#the-datatransfer-interface"><span class="secno">7.7.3 </span>The <code>DataTransfer</code> interface</a>
      <ol><li><a href="editing.html#the-datatransferitemlist-interface"><span class="secno">7.7.3.1 </span>The <code>DataTransferItemList</code> interface</a><li><a href="editing.html#the-datatransferitem-interface"><span class="secno">7.7.3.2 </span>The <code>DataTransferItem</code> interface</a></ol><li><a href="editing.html#the-dragevent-interface"><span class="secno">7.7.4 </span>The <code>DragEvent</code> interface</a><li><a href="editing.html#drag-and-drop-processing-model"><span class="secno">7.7.5 </span>Drag-and-drop processing model</a><li><a href="editing.html#dndevents"><span class="secno">7.7.6 </span>Events summary</a><li><a href="editing.html#the-draggable-attribute"><span class="secno">7.7.7 </span>The <code>draggable</code> attribute</a><li><a href="editing.html#the-dropzone-attribute"><span class="secno">7.7.8 </span>The <code>dropzone</code> attribute</a><li><a href="editing.html#security-risks-in-the-drag-and-drop-model"><span class="secno">7.7.9 </span>Security risks in the drag-and-drop model</a></ol></ol></ol></nav>

  <h2 id="editing"><span class="secno">7 </span><dfn>User interaction</dfn></h2>

  <h3 id="the-hidden-attribute"><span class="secno">7.1 </span>The <dfn data-anolis-xref="attr-hidden" id="attr-hidden"><code>hidden</code></dfn> attribute</h3>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> content
  attribute set. The <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute is a <a href="infrastructure.html#boolean-attribute">boolean
  attribute</a>. When specified on an element, it indicates that the element is not yet, or is no
  longer, directly relevant to the page's current state, or that it is being used to declare content
  to be reused by other parts of the page as opposed to being directly accessed by the user. <span class="impl">User agents should not render elements that have the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute specified. This requirement may be implemented
  indirectly through the style layer. For example, an HTML+CSS user agent could implement these
  requirements <a href="rendering.html#hiddenCSS">using the rules suggested in the Rendering
  section</a>.</span></p>

  <p class="note">Because this attribute is typically implemented using CSS, it's also possible to
  override it using CSS. For instance, a rule that applies 'display: block' to all elements will
  cancel the effects of the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute. Authors therefore
  have to take care when writing their style sheets to make sure that the attribute is still styled
  as expected.</p>

  <div class="example">

   <p>In the following skeletal example, the attribute is used to hide the Web game's main screen
   until the user logs in:</p>

   <pre>  &lt;h1&gt;The Example Game&lt;/h1&gt;
  &lt;section id="login"&gt;
   &lt;h2&gt;Login&lt;/h2&gt;
   &lt;form&gt;
    ...
    &lt;!-- calls login() once the user's credentials have been checked --&gt;
   &lt;/form&gt;
   &lt;script&gt;
    function login() {
      // switch screens
      document.getElementById('login').hidden = true;
      document.getElementById('game').hidden = false;
    }
   &lt;/script&gt;
  &lt;/section&gt;
  &lt;section id="game" hidden&gt;
   ...
  &lt;/section&gt;</pre>

  </div>

  <p>The <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute must not be used to hide content that
  could legitimately be shown in another presentation. For example, it is incorrect to use <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> to hide panels in a tabbed dialog, because the tabbed interface
  is merely a kind of overflow presentation — one could equally well just show all the form
  controls in one big page with a scrollbar. It is similarly incorrect to use this attribute to hide
  content just from one presentation — if something is marked <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>, it is hidden from all
  presentations, including, for instance, printers.</p><!--bug
  19406-->

  <!-- for example, "<a hidden href=#content>Skip to content</a>" would be inappropriate. -->
  <!-- (but only add that example if you first add some more good valid examples -->

  <p>Elements that are not themselves <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> must not
  <a href="links.html#hyperlink">hyperlink</a> to elements that are <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>. The <code data-anolis-xref="">for</code> attributes of <code><a href="forms.html#the-label-element">label</a></code> and <code><a href="forms.html#the-output-element">output</a></code> elements that are not
  themselves <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> must similarly not refer to elements that are
  <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>. In both cases, such references would cause user
  confusion.</p>

  <p>Elements and scripts may, however, refer to elements that are <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> in other contexts.</p>
  <div class="example">

   <p>For example, it would be incorrect to use the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute to link to a
   section marked with the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>
   attribute. If the content is not applicable or relevant, then there
   is no reason to link to it.</p>

   <p>It would be fine, however, to use the ARIA <code data-anolis-xref="attr-aria-describedby">aria-describedby</code> attribute to
   refer to descriptions that are themselves <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>. While hiding the descriptions
   implies that they are not useful alone, they could be written in
   such a way that they are useful in the specific context of being
   referenced from the images that they describe.</p>

   <p>Similarly, a <code><a href="scripting-1.html#the-canvas-element">canvas</a></code> element with the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute could be used by a
   scripted graphics engine as an off-screen buffer, and a form
   control could refer to a hidden <code><a href="forms.html#the-form-element">form</a></code> element using its
   <code data-anolis-xref="attr-fae-form"><a href="forms.html#attr-fae-form">form</a></code> attribute.</p>

  </div>

  <p>Accessibility APIs are encouraged to provide a way to expose
  structured content while marking it as hidden in the default view.
  Such content should not be perceivable to users in the normal document
  flow in any modality, whether using Assistive Technology (AT) or
  mainstream User Agents.</p>

  <p>When such features are available, User Agents may use them to
  expose the full semantics of <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>
  elements to AT when appropriate, if such content is referenced
  indirectly by an <a data-anolis-xref="concept-id" href="infrastructure.html#concept-id">ID reference</a> or
  <a href="infrastructure.html#valid-hash-name-reference">valid hash-name reference</a>. This allows ATs to access the
  structure of these <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> elements
  upon user request, while keeping the content hidden in all
  presentations of the normal document flow. Authors who wish to prevent
  user-initiated viewing of a <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>
  element should not reference the element with such a mechanism.</p>

  <p class="auth">Because some User Agents have flattened hidden content when
  exposing such content to AT, authors should not reference <code title="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> content which would lose essential
  meaning when flattened.</p>

  <div class="example">

   <p>For example, it would be incorrect to use the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code>
   attribute to link to a section marked with the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute.
   If the content is not applicable or relevant, then there is no reason to link to it.</p>

   <p>It would be fine, however, to use the ARIA <code data-anolis-xref="attr-aria-describedby">aria-describedby</code> attribute to refer to descriptions that are
   themselves <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>. While hiding the descriptions implies that
   they are not useful alone, they could be written in such a way that they are useful in the
   specific context of being referenced from the images that they describe.</p>

   <p>Similarly, a <code><a href="scripting-1.html#the-canvas-element">canvas</a></code> element with the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code>
   attribute could be used by a scripted graphics engine as an off-screen buffer, and a form control
   could refer to a hidden <code><a href="forms.html#the-form-element">form</a></code> element using its <code data-anolis-xref="attr-fae-form"><a href="forms.html#attr-fae-form">form</a></code> attribute.</p>

  </div>

  <p>Elements in a section hidden by the <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute are still
  active, e.g. scripts and form controls in such sections still execute and submit respectively.
  Only their presentation to the user changes.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-hidden" id="dom-hidden"><code>hidden</code></dfn> IDL attribute must <a href="infrastructure.html#reflect">reflect</a>
  the content attribute of the same name.</p>

  </div>



  <h3 id="inert-subtrees"><span class="secno">7.2 </span>Inert subtrees</h3>

<!--CLEANUP-->
  <p>A node (in particular elements and text nodes) can be marked as <dfn id="inert">inert</dfn>. When a node 
  is <a href="editing.html#inert">inert</a>, then the user agent must act as if the node was absent for
  the purposes of targeting user interaction events, may ignore the node for the purposes of text
  search user interfaces (commonly known as "find in page"), and may prevent the user from selecting
  text in that node. User agents should allow the user to override the restrictions on search and
  text selection, however.</p>

  <p class="example">For example, consider a page that consists of just a single <a href="editing.html#inert">inert</a>
  paragraph positioned in the middle of a <code><a href="sections.html#the-body-element">body</a></code>. If a user moves their pointing device
  from the <code><a href="sections.html#the-body-element">body</a></code> over to the <a href="editing.html#inert">inert</a> paragraph and clicks on the paragraph,
  no <code data-anolis-xref="event-mouseover">mouseover</code> event would be fired, and the <code data-anolis-xref="event-mousemove">mousemove</code> and <code data-anolis-xref="event-click"><a href="infrastructure.html#event-click">click</a></code> events would
  be fired on the <code><a href="sections.html#the-body-element">body</a></code> element rather than the paragraph.</p>

<!--CLEANUP-->
  <p class="note">When a node is inert, it also can't be
  <a href="editing.html#focusable">focusable</a>.</p>

  <p>An entire <code><a href="dom.html#document">Document</a></code> can be marked as <dfn id="blocked-by-a-modal-dialog">blocked by a modal dialog</dfn> <var data-anolis-xref="">subject</var>. While a <code><a href="dom.html#document">Document</a></code> is so marked, every node that is <a data-anolis-xref="in a Document" href="infrastructure.html#in-a-document">in the <code>Document</code></a>, with the exception of the <var data-anolis-xref="">subject</var> element and its descendants, must be marked
  <a href="editing.html#inert">inert</a>. (The elements excepted by this paragraph can additionally be marked
  <a href="editing.html#inert">inert</a> through other means; being part of a modal dialog does not "protect" a node
  from being marked <a href="editing.html#inert">inert</a>.)</p>

  <p>Only one element at a time can mark a <code><a href="dom.html#document">Document</a></code> as being <a href="editing.html#blocked-by-a-modal-dialog">blocked by a modal
  dialog</a>.</p>


<!--TOPIC:DOM APIs-->
  <h3 id="activation"><span class="secno">7.3 </span>Activation</h3>

  <!-- v2 idea: HTMLImageElement.click(x, y); or clickPoint(), if click() can't be done in IE; can
       this be emulated in IE by posting a synthetic mouse click event with those X and Y coords?
       (ack Csaba Gabor)
  -->

  <dl class="domintro"><dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-click"><a href="editing.html#dom-click">click</a></code>()</dt>

   <dd>

    <p>Acts as if the element was clicked.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-click" id="dom-click"><code>click()</code></dfn> method must <a href="dom.html#run-synthetic-click-activation-steps">run synthetic click
  activation steps</a> on the element.</p>

  </div>
<!--TOPIC:HTML-->


  <h3 id="focus"><span class="secno">7.4 </span>Focus</h3>

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%20%0A...%3Cform%3E%3Cinput%20name%3Da%20onfocus%3D%22value%2B%3D1%3Bd.name%3D%27a%27%3Bname%3D%27d%27%3Bb.focus()%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22value%2B%3D1%3Bc.focus()%22%3E%0A%3Cinput%20name%3Dc%20onfocus%3D%22value%2B%3D1%3Bd.focus()%22%3E%0A%3Cinput%20name%3Dd%20onfocus%3D%22value%2B%3D1%3Ba.focus()%22%3E -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onfocus%3D%22t.value%2B%3D%27af1%20%27%3Bb.focus()%3Balert(document.activeElement.name)%3Bt.value%2B%3D%27af2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27ab%20%27%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D%27bf1%20%27%3Bc.focus()%3Bt.value%2B%3D%27bf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27bb%20%27%3B%22%3E%0A%3Cinput%20name%3Dc%20onfocus%3D%22t.value%2B%3D%27cf1%20%27%3Bc.focus()%3Bt.value%2B%3D%27cf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27cb%20%27%3B%22%3E%0A -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%3Cbody%20onload%3D%22document.forms%5B0%5D.a.focus()%22%3E%0A...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onblur%3D%22t.value%2B%3D'ab%20'%3B%20b.focus()%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D'bf1%20'%3Ba.focus()%3Bt.value%2B%3D'bf2%20'%3B%22%20onblur%3D%22t.value%2B%3D'bb%20'%3B%22%3E -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%3Cbody%3E...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onfocus%3D%22t.value%2B%3D%27af%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27ab1%20%27%3Bb.focus()%3Bt.value%2B%3D%27ab2%20%27%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D%27bf1%20%27%3Ba.focus()%3Bt.value%2B%3D%27bf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27bb%20%27%3B%22%3E -->

  <!-- v2: more things to define, if no other specs define them:
   - define onfocus/onblur behaviour for Window
   - Other things to look at are IE's focus APIs (HTMLElement.setActive(),
     onBeforeActivate, onActivate, onBeforeDeactivate, onDeactivate):
       https://bugzilla.mozilla.org/show_bug.cgi?id=296471
       https://bugzilla.mozilla.org/show_bug.cgi?id=296469
       http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/setactive.asp
       http://msdn.microsoft.com/workshop/author/dhtml/reference/events/onbeforeactivate.asp
  -->

  <div class="impl">

  <p>When an element is <i>focused</i>, key events received by the document must be targeted at that
  element. There may be no element focused; when no element is focused, key events received by the
  document must be targeted at <a href="dom.html#the-body-element-0">the body element</a>, if there is one, or else at the
  <code><a href="dom.html#document">Document</a></code>'s root element, if there is one. If there is no root element, key events
  must not be fired.</p>

  <p>User agents may track focus for each <a href="browsers.html#browsing-context">browsing context</a> or <code><a href="dom.html#document">Document</a></code>
  individually, or may support only one focused element per <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>
  — user agents should follow platform conventions in this regard.</p>

  <p>Which elements within a <a href="browsers.html#top-level-browsing-context">top-level browsing context</a> currently have focus must be
  independent of whether or not the <a href="browsers.html#top-level-browsing-context">top-level browsing context</a> itself has the <i>system
  focus</i>.</p>

  <p id="bc-focus-ergo-bcc-focus">When a <a href="browsers.html#child-browsing-context">child browsing context</a> is focused, its
  <a href="browsers.html#browsing-context-container">browsing context container</a> must also have focus.</p>

  <p class="note">When an element is focused, the element matches the CSS <code>:focus</code>
  pseudo-class.</p>

  </div>


  <h4 id="sequential-focus-navigation-and-the-tabindex-attribute"><span class="secno">7.4.1 </span>Sequential focus navigation and the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute</h4>

  <p>The <dfn data-anolis-xref="attr-tabindex" id="attr-tabindex"><code>tabindex</code></dfn> content attribute allows authors to
  control whether an element is supposed to be focusable, whether it is supposed to be reachable
  using sequential focus navigation, and what is to be the relative order of the element for the
  purposes of sequential focus navigation. The name "tab index" comes from the common use of the
  "tab" key to navigate through the focusable elements. The term "tabbing" refers to moving forward
  through the focusable elements that can be reached using sequential focus navigation.</p>

  <p>The <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute, if specified, must have a value that
  is a <a href="infrastructure.html#valid-integer">valid integer</a>.</p>

  <div class="impl">

  <p>Each element can have a <dfn id="specially-focusable">tabindex focus flag</dfn> set, as defined
  below. This flag is a factor that contributes towards determining whether an element is
  <a href="editing.html#focusable">focusable</a>, as described in the next section.</p>

  <p>If the attribute is specified, it must be parsed using the <a href="infrastructure.html#rules-for-parsing-integers">rules for parsing
  integers</a>. The attribute's values have the following meanings:</p>

  <dl><dt>If the attribute is omitted or parsing the value returns an error</dt>

   <dd>

    <p>The user agent should follow platform conventions to determine if the element's
    <a href="editing.html#specially-focusable">tabindex focus flag</a> is set and, if so, whether the element can be reached using
    sequential focus navigation, and if so, what its relative order should be.</p>

    <p>Modulo platform conventions, it is suggested that for the following elements, the
    <a href="editing.html#specially-focusable">tabindex focus flag</a> be set:</p>

    <ul><li><code><a href="text-level-semantics.html#the-a-element">a</a></code> elements that have an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code>
     attribute</li>

     <li><code><a href="document-metadata.html#the-link-element">link</a></code> elements that have an <code data-anolis-xref="attr-link-href"><a href="document-metadata.html#attr-link-href">href</a></code> attribute</li>

     <li><code><a href="forms.html#the-button-element">button</a></code> elements</li>

     <li><code><a href="forms.html#the-input-element">input</a></code> elements whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute are
     not in the <a data-anolis-xref="attr-input-type-hidden" href="forms.html#hidden-state-(type=hidden)">Hidden</a> state</li>

     <li><code><a href="forms.html#the-select-element">select</a></code> elements</li>

     <li><code><a href="forms.html#the-textarea-element">textarea</a></code> elements</li>

     <li>Elements with a <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> attribute set, if that would
     enable the user agent to allow the user to begin a drag operations for those elements without
     the use of a pointing device</li>

     <li><a data-anolis-xref="editing host" href="editing.html#editing-host">Editing hosts</a></li>

     <li><a data-anolis-xref="browsing context container" href="browsers.html#browsing-context-container">Browsing context containers</a></li> <!-- like
     <iframe>s -->

    </ul><p class="note">One valid reason to ignore the platform conventions and always allow an element
    to be focused (by setting its <a href="editing.html#specially-focusable">tabindex focus flag</a>) would be if the user's only
    mechanism for activating an element is through a keyboard action that triggers the focused
    element.</p>

   </dd>

   <dt id="negative-tabindex">If the value is a negative integer</dt>

   <dd>

    <p>The user agent must set the element's <a href="editing.html#specially-focusable">tabindex focus flag</a>, but should not allow
    the element to be reached using sequential focus navigation.</p>

    <p class="note">One valid reason to ignore the requirement that sequential focus navigation not
    allow the author to lead to the element would be if the user's only mechanism for moving the
    focus is sequential focus navigation. For instance, a keyboard-only user would be unable to
    click on a text field with a negative <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code>, so that
    user's user agent would be well justified in allowing the user to tab to the control
    regardless.</p>

   </dd>

   <dt>If the value is a zero</dt>

   <dd>

    <p>The user agent must set the element's <a href="editing.html#specially-focusable">tabindex focus flag</a>, should allow the
    element to be reached using sequential focus navigation, and should follow platform conventions
    to determine the element's relative order.</p>

   </dd>

   <dt>If the value is greater than zero</dt>

   <dd>

    <p>The user agent must set the element's <a href="editing.html#specially-focusable">tabindex focus flag</a>, should allow the
    element to be reached using sequential focus navigation, and should place the element in the
    sequential focus navigation order so that it is:</p>

    <ul><li>before any <a href="editing.html#focusable">focusable</a> element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code>
     attribute has been omitted or whose value, when parsed, returns an error,</li>

     <li>before any <a href="editing.html#focusable">focusable</a> element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code>
     attribute has a value equal to or less than zero,</li>

     <li>after any element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute has a value
     greater than zero but less than the value of the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code>
     attribute on the element,</li>

     <li>after any element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute has a value
     equal to the value of the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute on the element
     but that is earlier in the document in <a href="infrastructure.html#tree-order">tree order</a> than the element,</li>

     <li>before any element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute has a value
     equal to the value of the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute on the element
     but that is later in the document in <a href="infrastructure.html#tree-order">tree order</a> than the element, and</li>

     <li>before any element whose <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute has a value
     greater than the value of the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute on the
     element.</li>

    </ul></dd>

  </dl><p>An element that has its <a href="editing.html#specially-focusable">tabindex focus flag</a> set but does not otherwise have an
  <a href="dom.html#activation-behavior">activation behavior</a> defined has an <a href="dom.html#activation-behavior">activation behavior</a> that does
  nothing.</p>

  <p class="note">This means that an element that is only focusable because of its <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> attribute will fire a <code data-anolis-xref="event-click"><a href="infrastructure.html#event-click">click</a></code>
  event in response to a non-mouse activation (e.g. hitting the "enter" key while the element is
  focused).</p>

  <p>The <dfn data-anolis-xref="dom-tabIndex" id="dom-tabindex"><code>tabIndex</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the value of the <code data-anolis-xref="attr-tabindex"><a href="editing.html#attr-tabindex">tabindex</a></code> content
  attribute. Its default value is 0 for elements that are focusable and −1 for elements that
  are not focusable.</p>

  </div>



  <div class="impl">

  <h4 id="focus-management"><span class="secno">7.4.2 </span>Focus management</h4>

  <p>An element is <dfn id="focusable">focusable</dfn> if all of the following conditions are met:</p>

  <ul><li>The element's <a href="editing.html#specially-focusable">tabindex focus flag</a> is set.</li>

   <li>The element is either <a href="rendering.html#being-rendered">being rendered</a> or <!-- CANVAS-FOCUS-FALLBACK --> is a
   descendant of a <code><a href="scripting-1.html#the-canvas-element">canvas</a></code> element that <a href="dom.html#represents">represents</a> <a href="dom.html#embedded-content-2">embedded
   content</a>.</li>

   <li>The element is not <a href="editing.html#inert">inert</a>.</li>

   <li>The element is not <a data-anolis-xref="concept-element-disabled" href="disabled-elements.html#concept-element-disabled">disabled</a>.</li>

  </ul><p>In addition, each shape that is generated for an <code><a href="embedded-content-0.html#the-area-element">area</a></code> element, any
  user-agent-provided interface components of <a data-anolis-xref="media element" href="embedded-content-0.html#media-element">media elements</a>
  (e.g. a play button), and distinct user interface components of form controls (e.g. "up" and
  "down" buttons on an <code data-anolis-xref="attr-input-type-number"><a href="forms.html#number-state-(type=number)">&lt;input type=number&gt;</a></code> spin
  control), should be <a href="editing.html#focusable">focusable</a>, unless platform conventions dictate otherwise or
  unless their corresponding element is <a data-anolis-xref="concept-element-disabled" href="disabled-elements.html#concept-element-disabled">disabled</a>. (A
  single <code><a href="embedded-content-0.html#the-area-element">area</a></code> element can correspond to multiple shapes, since image maps can be reused
  with multiple images on a page.)</p>

  <p>Notwithstanding the above, user agents may make <em>any</em> element or part of an element
  focusable, especially to aid with accessibility or to better match platform conventions.</p>

  <hr><p>The <dfn id="focusing-steps">focusing steps</dfn> for an element are as follows:</p>

  <ol><li><p>If the element is not <a data-anolis-xref="in a Document" href="infrastructure.html#in-a-document">in a <code>Document</code></a>, or if
   the element's <code><a href="dom.html#document">Document</a></code> has no <a href="browsers.html#browsing-context">browsing context</a>, or if the element's
   <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#browsing-context">browsing context</a> has no <a href="browsers.html#top-level-browsing-context">top-level browsing
   context</a>, or if the element is not <a href="editing.html#focusable">focusable</a>, or if the element is already
   focused, then abort these steps.</p>

   <li><p>If focusing the element will remove the focus from another element, then run the
   <a href="editing.html#unfocusing-steps">unfocusing steps</a> for that element.</li>

   <li>

    <p>Make the element the currently focused element in its <a href="browsers.html#top-level-browsing-context">top-level browsing
    context</a>.</p>

    <p>Some elements, most notably <code><a href="embedded-content-0.html#the-area-element">area</a></code>, can correspond to more than one distinct
    focusable area. If a particular area was indicated when the element was focused, then that is
    the area that must get focus; otherwise, e.g. when using the <code data-anolis-xref="dom-focus"><a href="editing.html#dom-focus">focus()</a></code> method, the first such region in tree order is the one that
    must be focused.</p>

   </li>

   <li>

    <p>The user agent may apply relevant platform-specific conventions for focusing widgets.</p>

    <p class="note">For example, some platforms select the contents of a text field when that field
    is focused.</p>

   </li>

   <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-focus">focus</code> at the element.</li>
   <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/723 -->

  </ol><p>User agents must synchronously run the <a href="editing.html#focusing-steps">focusing steps</a> for an element whenever the
  user moves the focus to a <a href="editing.html#focusable">focusable</a> element.</p>

  <p>The <dfn id="unfocusing-steps">unfocusing steps</dfn> for an element are as follows:</p>

  <ol><li><p>If the element is an <code><a href="forms.html#the-input-element">input</a></code> element, and the <code data-anolis-xref="event-input-change"><a href="forms.html#event-input-change">change</a></code> event applies to the element, and the element does not
   have a defined <a href="dom.html#activation-behavior">activation behavior</a>, and the user has changed the element's <a data-anolis-xref="concept-fe-value" href="forms.html#concept-fe-value">value</a> or its list of <a data-anolis-xref="concept-input-type-file-selected" href="forms.html#concept-input-type-file-selected">selected files</a> while the control was focused
   without committing that change, then <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> that bubbles named <code data-anolis-xref="event-change">change</code> at the element.</p>

   <li><p>Unfocus the element.</li>

   <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-blur">blur</code> at the element.</li>
   <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/723 -->

  </ol><p>When an element that is focused stops being a <a href="editing.html#focusable">focusable</a> element, or stops being
  focused without another element being explicitly focused in its stead, the user agent should
  synchronously run the <a href="editing.html#unfocusing-steps">unfocusing steps</a> for the affected element only.</p>

  <p class="example">For example, this might happen because the element is removed from its
  <code><a href="dom.html#document">Document</a></code>, or has a <code data-anolis-xref="attr-hidden"><a href="editing.html#the-hidden-attribute">hidden</a></code> attribute added. It would
  also happen to an <code><a href="forms.html#the-input-element">input</a></code> element when the element gets <a data-anolis-xref="concept-fe-disabled" href="forms.html#concept-fe-disabled">disabled</a>.</p>

  </div>


<!--TOPIC:DOM APIs-->
  <h4 id="document-level-focus-apis"><span class="secno">7.4.3 </span>Document-level focus APIs</h4>

  <dl class="domintro"><dt><var data-anolis-xref="">document</var> . <code data-anolis-xref="dom-document-activeElement"><a href="editing.html#dom-document-activeelement">activeElement</a></code></dt>

   <dd>

    <p>Returns the currently focused element.</p>

   </dd>

   <dt><var data-anolis-xref="">document</var> . <code data-anolis-xref="dom-document-hasFocus"><a href="editing.html#dom-document-hasfocus">hasFocus</a></code>()</dt>

   <dd>

    <p>Returns true if the document has focus; otherwise, returns false.</p>

   </dd>

   <dt><var data-anolis-xref="">window</var> . <code data-anolis-xref="dom-window-focus"><a href="editing.html#dom-window-focus">focus</a></code>()</dt>

   <dd>

    <p>Focuses the window. Use of this method is discouraged. Allow the user to control window focus
    instead.</p>

   </dd>

   <dt><var data-anolis-xref="">window</var> . <code data-anolis-xref="dom-window-blur"><a href="editing.html#dom-window-blur">blur</a></code>()</dt>

   <dd>

    <p>Unfocuses the window. Use of this method is discouraged. Allow the user to control window
    focus instead.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-document-activeElement" id="dom-document-activeelement"><code>activeElement</code></dfn> attribute on
  <code><a href="dom.html#document">Document</a></code> objects must return the element in the document that is focused. If no
  element in the <code><a href="dom.html#document">Document</a></code> is focused, this must return <a href="dom.html#the-body-element-0">the body
  element</a>.</p>

  <p class="note">When a <a href="browsers.html#child-browsing-context">child browsing context</a> is focused, its <a href="browsers.html#browsing-context-container">browsing context
  container</a> is also focused, <a href="editing.html#bc-focus-ergo-bcc-focus">by definition</a>. For
  example, if the user moves the focus to a text field in an <code><a href="embedded-content-0.html#the-iframe-element">iframe</a></code>, the
  <code><a href="embedded-content-0.html#the-iframe-element">iframe</a></code> is the element with focus in the <a href="browsers.html#parent-browsing-context">parent browsing context</a>.</p>

  <p>The <dfn data-anolis-xref="dom-document-hasFocus" id="dom-document-hasfocus"><code>hasFocus()</code></dfn> method on
  <code><a href="dom.html#document">Document</a></code> objects must return true if the <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#browsing-context">browsing
  context</a> is focused, and all its <a data-anolis-xref="ancestor browsing context" href="browsers.html#ancestor-browsing-context">ancestor browsing
  contexts</a> are also focused, and the <a href="browsers.html#top-level-browsing-context">top-level browsing context</a> has the
  <i>system focus</i>. If the <code><a href="dom.html#document">Document</a></code> has no <a href="browsers.html#browsing-context">browsing context</a> or if its
  <a href="browsers.html#browsing-context">browsing context</a> has no <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>, then the method will
  always return false.</p>

  <p>The <dfn data-anolis-xref="dom-window-focus" id="dom-window-focus"><code>focus()</code></dfn> method on the <code><a href="browsers.html#window">Window</a></code>
  object, when invoked, provides a hint to the user agent that the script believes the user might be
  interested in the contents of the <a href="browsers.html#browsing-context">browsing context</a> of the <code><a href="browsers.html#window">Window</a></code> object
  on which the method was invoked.</p>

  <p>User agents are encouraged to have this <code data-anolis-xref="dom-window-focus"><a href="editing.html#dom-window-focus">focus()</a></code> method
  trigger some kind of notification.</p>

  <p>The <dfn data-anolis-xref="dom-window-blur" id="dom-window-blur"><code>blur()</code></dfn> method on the <code><a href="browsers.html#window">Window</a></code>
  object, when invoked, provides a hint to the user agent that the script believes the user probably
  is not currently interested in the contents of the <a href="browsers.html#browsing-context">browsing context</a> of the
  <code><a href="browsers.html#window">Window</a></code> object on which the method was invoked, but that the contents might become
  interesting again in the future.</p>

  <p>User agents are encouraged to ignore calls to this <code data-anolis-xref="dom-window-blur"><a href="editing.html#dom-window-blur">blur()</a></code>
  method entirely.</p>

  <p class="note">Historically the <code data-anolis-xref="dom-window-blur"><a href="editing.html#dom-window-blur">focus()</a></code> and <code data-anolis-xref="dom-window-blur"><a href="editing.html#dom-window-blur">blur()</a></code> methods actually affected the system focus, but hostile
  sites widely abuse this behavior to the user's detriment.</p>

  </div>


  <h4 id="element-level-focus-apis"><span class="secno">7.4.4 </span>Element-level focus APIs</h4>

  <dl class="domintro"><dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-focus"><a href="editing.html#dom-focus">focus</a></code>()</dt>

   <dd>

    <p>Focuses the element.</p>

   </dd>

   <dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-blur"><a href="editing.html#dom-blur">blur</a></code>()</dt>

   <dd>

    <p>Unfocuses the element. Use of this method is discouraged. Focus another element instead.</p>

    <p>Do not use this method to hide the focus ring. Do not use any
    other method that hides the focus ring from keyboard users, in
    particular do not use a CSS rule to override the 'outline'
    property. Removal of the focus ring leads to serious accessibility
    issues for users who navigate and interact with interactive
    content using the keyboard.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-focus" id="dom-focus"><code>focus()</code></dfn> method, when invoked, must run the
  following algorithm:</p>

  <ol><li><p>If the element is marked as <i><a href="editing.html#locked-for-focus">locked for focus</a></i>, then abort these steps.</li>

   <li><p>Mark the element as <dfn id="locked-for-focus">locked for focus</dfn>.</li>

   <li><p>Run the <a href="editing.html#focusing-steps">focusing steps</a> for the element.</li>

   <li><p>Unmark the element as <i><a href="editing.html#locked-for-focus">locked for focus</a></i>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-blur" id="dom-blur"><code>blur()</code></dfn> method, when invoked, should run the
  <a href="editing.html#unfocusing-steps">unfocusing steps</a> for the element on which the method was called instead. User agents
  may selectively or uniformly ignore calls to this method for usability reasons.</p>

  <p class="example">For example, if the <code data-anolis-xref="dom-blur"><a href="editing.html#dom-blur">blur()</a></code> method is unwisely
  being used to remove the focus ring for aesthetics reasons, the page would become unusable by
  keyboard users. Ignoring calls to this method would thus allow keyboard users to interact with the
  page.</p>

  </div>
<!--TOPIC:HTML-->



  <h3 id="assigning-keyboard-shortcuts"><span class="secno">7.5 </span>Assigning keyboard shortcuts</h3>

  <h4 id="introduction-5"><span class="secno">7.5.1 </span>Introduction</h4>

  <p><i>This section is non-normative.</i></p>
  <p>Each element that can be activated or focused can be assigned a single key combination to
  activate it, using the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute.</p>

  <p>The exact shortcut is determined by the user agent, based on information about the user's
  keyboard, what keyboard shortcuts already exist on the platform, and what other shortcuts have
  been specified on the page, using the information provided in the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute as a guide.</p>

  <p>In order to ensure that a relevant keyboard shortcut is available on a wide variety of input
  devices, the author can provide a number of alternatives in the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute.</p>

  <p>Each alternative consists of a single character, such as a letter or digit.</p>

  <p>User agents can provide users with a list of the keyboard shortcuts, but authors are encouraged
  to do so also. The <code data-anolis-xref="dom-accessKeyLabel"><a href="editing.html#dom-accesskeylabel">accessKeyLabel</a></code> IDL attribute returns a
  string representing the actual key combination assigned by the user agent.</p>

  <div class="example">

   <p>In this example, an author has provided a button that can be invoked using a shortcut key. To
   support full keyboards, the author has provided "C" as a possible key. To support devices
   equipped only with numeric keypads, the author has provided "1" as another possibly key.</p>

   <pre>&lt;input type=button value=Collect onclick="collect()"
       <strong>accesskey="C 1"</strong> id=c&gt;</pre>

  </div>

  <div class="example">

   <p>To tell the user what the shortcut key is, the author has this script here opted to explicitly
   add the key combination to the button's label:</p>

   <pre>function addShortcutKeyLabel(button) {
<strong>  if (button.accessKeyLabel != '')
    button.value += ' (' + button.accessKeyLabel + ')';</strong>
}
addShortcutKeyLabel(document.getElementById('c'));</pre>

   <p>Browsers on different platforms will show different labels, even for the same key combination,
   based on the convention prevalent on that platform. For example, if the key combination is the
   Control key, the Shift key, and the letter C, a Windows browser might display
   "<samp>Ctrl+Shift+C</samp>", whereas a Mac browser might display "<samp>^⇧C</samp>", while
   an Emacs browser might just display "<samp>C-C</samp>". Similarly, if the key combination is the
   Alt key and the Escape key, Windows might use "<samp>Alt+Esc</samp>", Mac might use
   "<samp>⌥⎋</samp>", and an Emacs browser might use "<samp>M-ESC</samp>" or
   "<samp>ESC ESC</samp>".</p>

   <p>In general, therefore, it is unwise to attempt to parse the value returned from the <code data-anolis-xref="dom-accessKeyLabel"><a href="editing.html#dom-accesskeylabel">accessKeyLabel</a></code> IDL attribute.</p>

  </div>


  <h4 id="the-accesskey-attribute"><span class="secno">7.5.2 </span>The <dfn data-anolis-xref="attr-accesskey" id="attr-accesskey"><code>accesskey</code></dfn> attribute</h4>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code>
  content attribute set. The <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute's value is used
  by the user agent as a guide for creating a keyboard shortcut that activates or focuses the
  element.</p>

  <p>If specified, the value must be an <a href="infrastructure.html#ordered-set-of-unique-space-separated-tokens">ordered set of unique space-separated tokens</a>
  that are <a href="infrastructure.html#case-sensitive">case-sensitive</a>, each of which must be exactly one Unicode code point in
  length.</p>

  <div class="example">

   <p>In the following example, a variety of links are given with access keys so that keyboard users
   familiar with the site can more quickly navigate to the relevant pages:</p>

   <pre>&lt;nav&gt;
 &lt;p&gt;
  &lt;a title="Consortium Activities" accesskey="A" href="/Consortium/activities"&gt;Activities&lt;/a&gt; |
  &lt;a title="Technical Reports and Recommendations" accesskey="T" href="/TR/"&gt;Technical Reports&lt;/a&gt; |
  &lt;a title="Alphabetical Site Index" accesskey="S" href="/Consortium/siteindex"&gt;Site Index&lt;/a&gt; |
  &lt;a title="About This Site" accesskey="B" href="/Consortium/"&gt;About Consortium&lt;/a&gt; |
  &lt;a title="Contact Consortium" accesskey="C" href="/Consortium/contact"&gt;Contact&lt;/a&gt;
 &lt;/p&gt;
&lt;/nav&gt;</pre>

  </div>

  <div class="example">

   <p>In the following example, the search field is given two possible access keys, "s" and "0" (in
   that order). A user agent on a device with a full keyboard might pick
   <kbd><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd><a href="text-level-semantics.html#the-s-element">S</a></kbd></kbd> as the shortcut key, while a user agent on
   a small device with just a numeric keypad might pick just the plain unadorned key
   <kbd><kbd>0</kbd></kbd>:</p>

   <pre>&lt;form action="/search"&gt;
 &lt;label&gt;Search: &lt;input type="search" name="q" accesskey="s 0"&gt;&lt;/label&gt;
 &lt;input type="submit"&gt;
&lt;/form&gt;</pre>

  </div>

  <div class="example">

   <p>In the following example, a button has possible access keys described. A script then tries to
   update the button's label to advertise the key combination the user agent selected.</p>

   <pre>&lt;input type=submit accesskey="N @ 1" value="Compose"&gt;
...
&lt;script&gt;
 function labelButton(button) {
   if (button.accessKeyLabel)
     button.value += ' (' + button.accessKeyLabel + ')';
 }
 var inputs = document.getElementsByTagName('input');
 for (var i = 0; i &lt; inputs.length; i += 1) {
   if (inputs[i].type == "submit")
     labelButton(inputs[i]);
 }
&lt;/script&gt;</pre>

   <p>On one user agent, the button's label might become "<samp>Compose (⌘N)</samp>". On
   another, it might become "<samp>Compose (Alt+⇧+1)</samp>". If the user agent doesn't
   assign a key, it will be just "<samp>Compose</samp>". The exact string depends on what the
   <a href="editing.html#assigned-access-key">assigned access key</a> is, and on how the user agent represents that key
   combination.</p>

  </div>


  <div class="impl">

  <h4 id="processing-model-4"><span class="secno">7.5.3 </span>Processing model</h4>

  <p>An element's <dfn id="assigned-access-key">assigned access key</dfn> is a key combination derived from the element's
  <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> content attribute. Initially, an element must not
  have an <a href="editing.html#assigned-access-key">assigned access key</a>.</p>

  <p>Whenever an element's <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute is set, changed,
  or removed, the user agent must update the element's <a href="editing.html#assigned-access-key">assigned access key</a> by running
  the following steps:</p>

  <ol><li><p>If the element has no <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute, then skip
   to the <i>fallback</i> step below.</li>

   <li><p>Otherwise, <a data-anolis-xref="split a string on spaces" href="infrastructure.html#split-a-string-on-spaces">split the attribute's value on
   spaces</a>, and let <var data-anolis-xref="">keys</var> be the resulting tokens.</li>

   <li>

    <p>For each value in <var data-anolis-xref="">keys</var> in turn, in the order the tokens appeared in the
    attribute's value, run the following substeps:</p>

    <ol><li><p>If the value is not a string exactly one Unicode code point in length, then skip the
     remainder of these steps for this value.</li>

     <li><p>If the value does not correspond to a key on the system's keyboard, then skip the
     remainder of these steps for this value.</li>

     <li><p>If the user agent can find a mix of zero or more modifier keys that, combined with the
     key that corresponds to the value given in the attribute, can be used as the access key, then
     the user agent may assign that combination of keys as the element's <a href="editing.html#assigned-access-key">assigned access
     key</a> and abort these steps.</li>

    </ol></li>

   <li><p><i>Fallback</i>: Optionally, the user agent may assign a key combination of its choosing
   as the element's <a href="editing.html#assigned-access-key">assigned access key</a> and then abort these steps.</li>

   <li><p>If this step is reached, the element has no <a href="editing.html#assigned-access-key">assigned access key</a>.</li>

  </ol><p>Once a user agent has selected and assigned an access key for an element, the user agent should
  not change the element's <a href="editing.html#assigned-access-key">assigned access key</a> unless the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> content attribute is changed or the element is moved to
  another <code><a href="dom.html#document">Document</a></code>.</p>

  <p class="note">User agents might expose elements that have
  an <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> attribute in other ways as well, e.g. in a menu
  displayed in response to a specific key combination.</p> <!-- the actual conformance criteria for
  this is in the section that defines commands -->

  <hr><p>The <dfn data-anolis-xref="dom-accessKey" id="dom-accesskey"><code>accessKey</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-accesskey"><a href="editing.html#the-accesskey-attribute">accesskey</a></code> content attribute.</p>

  <p>The <dfn data-anolis-xref="dom-accessKeyLabel" id="dom-accesskeylabel"><code>accessKeyLabel</code></dfn> IDL attribute must return
  a string that represents the element's <a href="editing.html#assigned-access-key">assigned access key</a>, if any. If the element
  does not have one, then the IDL attribute must return the empty string.</p>

  </div>



  <h3 id="editing-0"><span class="secno">7.6 </span>Editing</h3>

  <h4 id="contenteditable"><span class="secno">7.6.1 </span>Making document regions editable: The <code data-anolis-xref="attr-contenteditable"><a href="editing.html#attr-contenteditable">contenteditable</a></code> content attribute</h4>

  <p>The <dfn data-anolis-xref="attr-contenteditable" id="attr-contenteditable"><code>contenteditable</code></dfn> attribute is an
  <a href="infrastructure.html#enumerated-attribute">enumerated attribute</a> whose keywords are the empty string, <code data-anolis-xref="">true</code>,
  and <code data-anolis-xref="">false</code>. The empty string and the <code data-anolis-xref="">true</code> keyword map
  to the <i>true</i> state. The <code data-anolis-xref="">false</code> keyword maps to the <i>false</i> state.
  In addition, there is a third state, the <i>inherit</i> state, which is the <i>missing value
  default</i> (and the <i>invalid value default</i>).</p>

  <p>The <i>true</i> state indicates that the element is editable. The <i>inherit</i> state
  indicates that the element is editable if its parent is. The <i>false</i> state indicates that the
  element is not editable.</p>

  <dl class="domintro"><dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-contentEditable"><a href="editing.html#dom-contenteditable">contentEditable</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns "<code data-anolis-xref="">true</code>", "<code data-anolis-xref="">false</code>", or "<code data-anolis-xref="">inherit</code>", based on the state of the <code data-anolis-xref="attr-contenteditable"><a href="editing.html#attr-contenteditable">contenteditable</a></code> attribute.</p>

    <p>Can be set, to change that state.</p>

    <p>Throws a <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code> exception if the new value isn't one of those strings.</p>

   </dd>

   <dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-isContentEditable"><a href="editing.html#dom-iscontenteditable">isContentEditable</a></code></dt>

   <dd>

    <p>Returns true if the element is editable; otherwise, returns false.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-contentEditable" id="dom-contenteditable"><code>contentEditable</code></dfn> IDL attribute, on
  getting, must return the string "<code data-anolis-xref="">true</code>" if the content attribute is set to
  the true state, "<code data-anolis-xref="">false</code>" if the content attribute is set to the false state,
  and "<code data-anolis-xref="">inherit</code>" otherwise. On setting, if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> match for the string "<code data-anolis-xref="">inherit</code>" then the content
  attribute must be removed, if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for
  the string "<code data-anolis-xref="">true</code>" then the content attribute must be set to the string
  "<code data-anolis-xref="">true</code>", if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for
  the string "<code data-anolis-xref="">false</code>" then the content attribute must be set to the string
  "<code data-anolis-xref="">false</code>", and otherwise the attribute setter must throw a
  <code><a href="infrastructure.html#syntaxerror">SyntaxError</a></code> exception.</p>

  <p>The <dfn data-anolis-xref="dom-isContentEditable" id="dom-iscontenteditable"><code>isContentEditable</code></dfn> IDL attribute, on
  getting, must return true if the element is either an <a href="editing.html#editing-host">editing host</a> or
  <a href="editing.html#editable">editable</a>, and false otherwise.</p>

  </div>


  <h4 id="making-entire-documents-editable:-the-designmode-idl-attribute"><span class="secno">7.6.2 </span>Making entire documents editable: The <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> IDL attribute</h4>

  <div class="impl">

  <p>Documents have a <dfn data-anolis-xref="dom-document-designMode" id="designMode"><code>designMode</code></dfn>, which can be either enabled or
  disabled.</p>

  </div>

  <dl class="domintro"><dt><var data-anolis-xref="">document</var> . <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns "<code data-anolis-xref="">on</code>" if the document is editable, and "<code data-anolis-xref="">off</code>" if it isn't.</p>

    <p>Can be set, to change the document's current state. This focuses the document and resets the
    selection in that document.</p>

   </dd>

  </dl><div class="impl">

  <p>The <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> IDL attribute on the
  <code><a href="dom.html#document">Document</a></code> object takes two values, "<code data-anolis-xref="">on</code>" and "<code data-anolis-xref="">off</code>". On setting, the new value must be compared in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> manner to these two values; if it matches the "<code data-anolis-xref="">on</code>"
  value, then <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> must be enabled, and if it
  matches the "<code data-anolis-xref="">off</code>" value, then <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> must be disabled. Other values must be
  ignored.</p>

  <p>On getting, if <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> is enabled, the IDL
  attribute must return the value "<code data-anolis-xref="">on</code>"; otherwise it is disabled, and the
  attribute must return the value "<code data-anolis-xref="">off</code>".</p>

  <p>The last state set must persist until the document is destroyed or the state is changed.
  Initially, documents must have their <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code>
  disabled.</p>

  <p>When the <code data-anolis-xref="dom-document-designMode"><a href="editing.html#designMode">designMode</a></code> changes from being disabled to
  being enabled, the user agent must synchronously reset the document's <a href="editing.html#active-range">active range</a>'s
  start and end boundary points to be at the start of the <code><a href="dom.html#document">Document</a></code> and then run the
  <a href="editing.html#focusing-steps">focusing steps</a> for the root element of the <code><a href="dom.html#document">Document</a></code>, if any.</p>

  </div>


  <h4 id="best-practices-for-in-page-editors"><span class="secno">7.6.3 </span>Best practices for in-page editors</h4>

  <p>Authors are encouraged to set the 'white-space' property on <a data-anolis-xref="editing host" href="editing.html#editing-host">editing
  hosts</a> and on markup that was originally created through these editing mechanisms to the
  value 'pre-wrap'. Default HTML whitespace handling is not well suited to WYSIWYG editing, and line
  wrapping will not work correctly in some corner cases if 'white-space' is left at its default
  value.</p>

  <div class="example">

   <p>As an example of problems that occur if the default 'normal' value is used instead, consider
   the case of the user typing "<kbd>yellow␣␣ball</kbd>", with two spaces (here
   represented by "␣") between the words. With the editing rules in place for the default
   value of 'white-space' ('normal'), the resulting markup will either consist of
   "<samp>yellow&amp;nbsp; ball</samp>" or "<samp>yellow &amp;nbsp;ball</samp>"; i.e.,
   there will be a non-breaking space between the two words in addition to the regular space. This
   is necessary because the 'normal' value for 'white-space' requires adjacent regular spaces to be
   collapsed together.</p>

   <p>In the former case, "<samp>yellow⍽</samp>" might wrap to the next line ("⍽"
   being used here to represent a non-breaking space) even though "<samp>yellow</samp>" alone might
   fit at the end of the line; in the latter case, "<samp>⍽ball</samp>", if wrapped to the
   start of the line, would have visible indentation from the non-breaking space.</p>

   <p>When 'white-space' is set to 'pre-wrap', however, the editing rules will instead simply put
   two regular spaces between the words, and should the two words be split at the end of a line, the
   spaces would be neatly removed from the rendering.</p>

  </div>



  <h4 id="editing-apis"><span class="secno">7.6.4 </span>Editing APIs</h4>


  <p>The definition of the terms <dfn id="active-range">active range</dfn>, <dfn id="editing-host">editing host</dfn>, and
  <dfn id="editable">editable</dfn>, the user interface requirements of elements that are <a data-anolis-xref="editing
  host" href="editing.html#editing-host">editing hosts</a> or <a href="editing.html#editable">editable</a>, the

  <dfn data-anolis-xref="dom-document-execCommand" id="execCommand"><code>execCommand()</code></dfn>,
  <dfn data-anolis-xref="dom-document-queryCommandEnabled" id="dom-document-querycommandenabled"><code>queryCommandEnabled()</code></dfn>,
  <dfn data-anolis-xref="dom-document-queryCommandIndeterm" id="dom-document-querycommandindeterm"><code>queryCommandIndeterm()</code></dfn>,
  <dfn data-anolis-xref="dom-document-queryCommandState" id="dom-document-querycommandstate"><code>queryCommandState()</code></dfn>,
  <dfn data-anolis-xref="dom-document-queryCommandSupported" id="dom-document-querycommandsupported"><code>queryCommandSupported()</code></dfn>, and
  <dfn data-anolis-xref="dom-document-queryCommandValue" id="dom-document-querycommandvalue"><code>queryCommandValue()</code></dfn>

  methods, text selections, and the <dfn id="delete-the-selection">delete the selection</dfn> algorithm are defined in the
  HTML Editing APIs specification. The interaction of editing and the undo/redo features in user
  agents is defined by the UndoManager and DOM Transaction specification. <a href="references.html#refsEDITING">[EDITING]</a> <a href="references.html#refsUNDO">[UNDO]</a></p>

  <!-- those might get merged in here eventually -->



  <h4 id="spelling-and-grammar-checking"><span class="secno">7.6.5 </span>Spelling and grammar checking</h4>

  <div class="impl">

  <p>User agents can support the checking of spelling and grammar of editable text, either in form
  controls (such as the value of <code><a href="forms.html#the-textarea-element">textarea</a></code> elements), or in elements in an <a href="editing.html#editing-host">editing
  host</a> (e.g. using <code data-anolis-xref="attr-contenteditable"><a href="editing.html#attr-contenteditable">contenteditable</a></code>).</p>

  <p>For each element, user agents must establish a <dfn data-anolis-xref="concept-spellcheck-default" id="concept-spellcheck-default">default
  behavior</dfn>, either through defaults or through preferences expressed by the user. There are
  three possible default behaviors for each element:</p>

  <dl><dt><dfn data-anolis-xref="concept-spellcheck-default-true" id="concept-spellcheck-default-true">true-by-default</dfn>

   <dd>The element will be checked for spelling and grammar if its contents are editable.

   <dt><dfn data-anolis-xref="concept-spellcheck-default-false" id="concept-spellcheck-default-false">false-by-default</dfn>

   <dd>The element will never be checked for spelling and grammar.

   <dt><dfn data-anolis-xref="concept-spellcheck-default-inherit" id="concept-spellcheck-default-inherit">inherit-by-default</dfn>

   <dd>The element's default behavior is the same as its parent element's. Elements that have no
   parent element cannot have this as their default behavior.

  </dl><hr></div>

  <p>The <dfn data-anolis-xref="attr-spellcheck" id="attr-spellcheck"><code>spellcheck</code></dfn> attribute is an <a href="infrastructure.html#enumerated-attribute">enumerated
  attribute</a> whose keywords are the empty string, <code data-anolis-xref="">true</code> and <code data-anolis-xref="">false</code>. The empty string and the <code data-anolis-xref="">true</code> keyword map to the
  <i>true</i> state. The <code data-anolis-xref="">false</code> keyword maps to the <i>false</i> state. In
  addition, there is a third state, the <i>default</i> state, which is the <i>missing value
  default</i> (and the <i>invalid value default</i>).</p>

  <p class="note">The <i>true</i> state indicates that the element is to have its spelling and
  grammar checked. The <i>default</i> state indicates that the element is to act according to a
  default behavior, possibly based on the parent element's own <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> state, as defined below. The <i>false</i> state
  indicates that the element is not to be checked.</p>

  <div class="impl">

  <hr></div>

  <dl class="domintro"><dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-spellcheck"><a href="editing.html#dom-spellcheck">spellcheck</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if the element is to have its spelling and grammar checked; otherwise, returns
    false.</p>

    <p>Can be set, to override the default and set the <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute.</p>

   </dd>
  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-spellcheck" id="dom-spellcheck"><code>spellcheck</code></dfn> IDL attribute, on getting, must
  return true if the element's <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute is
  in the <i>true</i> state, or if the element's <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code>
  content attribute is in the <i>default</i> state and the element's <a data-anolis-xref="concept-spellcheck-default" href="editing.html#concept-spellcheck-default">default behavior</a> is <a data-anolis-xref="concept-spellcheck-default-true" href="editing.html#concept-spellcheck-default-true">true-by-default</a>, or if the element's <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute is in the <i>default</i> state and the
  element's <a data-anolis-xref="concept-spellcheck-default" href="editing.html#concept-spellcheck-default">default behavior</a> is <a data-anolis-xref="concept-spellcheck-default-inherit" href="editing.html#concept-spellcheck-default-inherit">inherit-by-default</a> and the element's parent
  element's <code data-anolis-xref="dom-spellcheck"><a href="editing.html#dom-spellcheck">spellcheck</a></code> IDL attribute would return true;
  otherwise, if none of those conditions applies, then the attribute must instead return false.</p>

  <p class="note">The <code data-anolis-xref="dom-spellcheck"><a href="editing.html#dom-spellcheck">spellcheck</a></code> IDL attribute is not affected
  by user preferences that override the <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content
  attribute, and therefore might not reflect the actual spellchecking state.</p>

  <p>On setting, if the new value is true, then the element's <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute must be set to the literal string
  "<code data-anolis-xref="">true</code>", otherwise it must be set to the literal string "<code data-anolis-xref="">false</code>".

  <hr><p>User agents must only consider the following pieces of text as checkable for the purposes of
  this feature:</p>

  <ul><li>The <a data-anolis-xref="concept-fe-value" href="forms.html#concept-fe-value">value</a> of <code><a href="forms.html#the-input-element">input</a></code> elements whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attributes are in the <a data-anolis-xref="attr-input-type-text" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Text</a>, <a data-anolis-xref="attr-input-type-search" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Search</a>,
   <a data-anolis-xref="attr-input-type-url" href="forms.html#url-state-(type=url)">URL</a>, or <a data-anolis-xref="attr-input-type-email" href="forms.html#e-mail-state-(type=email)">E-mail</a> states and that are <i data-anolis-xref="concept-fe-mutable"><a href="forms.html#concept-fe-mutable">mutable</a></i> (i.e. that do not have the <code data-anolis-xref="attr-input-readonly"><a href="forms.html#attr-input-readonly">readonly</a></code> attribute specified and that are not <a data-anolis-xref="concept-fe-disabled" href="forms.html#concept-fe-disabled">disabled</a>).</li>

   <li>The <a data-anolis-xref="concept-fe-value" href="forms.html#concept-fe-value">value</a> of <code><a href="forms.html#the-textarea-element">textarea</a></code> elements that do not
   have a <code data-anolis-xref="attr-textarea-readonly"><a href="forms.html#attr-textarea-readonly">readonly</a></code> attribute and that are not <a data-anolis-xref="concept-fe-disabled" href="forms.html#concept-fe-disabled">disabled</a>.</li>

   <li>Text in <code><a href="infrastructure.html#text-0">Text</a></code> nodes that are children of <a data-anolis-xref="editing host" href="editing.html#editing-host">editing
   hosts</a> or <a href="editing.html#editable">editable</a> elements.</li>

   <li>Text in attributes of <a href="editing.html#editable">editable</a> elements.</li>

  </ul><p>For text that is part of a <code><a href="infrastructure.html#text-0">Text</a></code> node, the element with which the text is
  associated is the element that is the immediate parent of the first character of the word,
  sentence, or other piece of text. For text in attributes, it is the attribute's element. For the
  values of <code><a href="forms.html#the-input-element">input</a></code> and <code><a href="forms.html#the-textarea-element">textarea</a></code> elements, it is the element itself.</p>

  <p>To determine if a word, sentence, or other piece of text in an applicable element (as defined
  above) is to have spelling- and grammar-checking enabled, the UA must use the following
  algorithm:</p>

  <ol><!-- user override --><li>If the user has disabled the checking for this text, then the checking is disabled.</li>

   <li>Otherwise, if the user has forced the checking for this text to always be enabled, then the
   checking is enabled.</li>

   <!-- content attribute: on, off -->

   <li>Otherwise, if the element with which the text is associated has a <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute, then: if that attribute is in the
   <i>true</i> state, then checking is enabled; otherwise, if that attribute is in the <i>false</i>
   state, then checking is disabled.</li>

   <!-- inherit, if there is one to inherit from -->

   <li>Otherwise, if there is an ancestor element with a <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code> content attribute that is not in the <i>default</i>
   state, then: if the nearest such ancestor's <code data-anolis-xref="attr-spellcheck"><a href="editing.html#attr-spellcheck">spellcheck</a></code>
   content attribute is in the <i>true</i> state, then checking is enabled; otherwise, checking is
   disabled.</li>

   <!-- default -->

   <li>Otherwise, if the element's <a data-anolis-xref="concept-spellcheck-default" href="editing.html#concept-spellcheck-default">default behavior</a>
   is <a data-anolis-xref="concept-spellcheck-default-true" href="editing.html#concept-spellcheck-default-true">true-by-default</a>, then checking is
   enabled.</li>

   <li>Otherwise, if the element's <a data-anolis-xref="concept-spellcheck-default" href="editing.html#concept-spellcheck-default">default behavior</a>
   is <a data-anolis-xref="concept-spellcheck-default-false" href="editing.html#concept-spellcheck-default-false">false-by-default</a>, then checking is
   disabled.</li>

   <!-- default inheritance -->

   <li>Otherwise, if the element's parent element has <em>its</em> checking enabled, then checking
   is enabled.</li>

   <li>Otherwise, checking is disabled.</li>

  </ol><p>If the checking is enabled for a word/sentence/text, the user agent should indicate spelling
  and grammar errors in that text. User agents should take into account the other semantics given in
  the document when suggesting spelling and grammar corrections. User agents may use the language of
  the element to determine what spelling and grammar rules to use, or may use the user's preferred
  language settings. UAs should use <code><a href="forms.html#the-input-element">input</a></code> element attributes such as <code data-anolis-xref="attr-input-pattern"><a href="forms.html#attr-input-pattern">pattern</a></code> to ensure that the resulting value is valid, where
  possible.</p>

  <p>If checking is disabled, the user agent should not indicate spelling or grammar errors for that
  text.</p>

  <p>Even when checking is enabled, user agents may opt to not report spelling or grammar errors in
  text that the user agent deems the user has no interest in having checked (e.g. text that was
  already present when the page was loaded, or that the user did not type, or text in controls that
  the user has not focused, or in parts of e-mail addresses that the user agent is not confident
  were misspelt).</p>

  <div class="example">

   <p>The element with ID "a" in the following example would be the one used to determine if the
   word "Hello" is checked for spelling errors. In this example, it would not be.</p>

   <pre>&lt;div contenteditable="true"&gt;
 &lt;span spellcheck="false" id="a"&gt;Hell&lt;/span&gt;&lt;em&gt;o!&lt;/em&gt;
&lt;/div&gt;</pre>

   <p>The element with ID "b" in the following example would have checking enabled (the leading
   space character in the attribute's value on the <code><a href="forms.html#the-input-element">input</a></code> element causes the attribute
   to be ignored, so the ancestor's value is used instead, regardless of the default).</p>

   <pre class="bad">&lt;p spellcheck="true"&gt;
 &lt;label&gt;Name: &lt;input spellcheck=" false" id="b"&gt;&lt;/label&gt;
&lt;/p&gt;</pre>

  </div>

  </div>

  <p class="note">This specification does not define the user interface for spelling and grammar
  checkers. A user agent could offer on-demand checking, could perform continuous checking while the
  checking is enabled, or could use other interfaces.</p>


  <h3 id="dnd"><span class="secno">7.7 </span><dfn>Drag and drop</dfn></h3>

<!-- v2: ideas for drag and drop:

     * being able to animate a drop target:

       > To implement this with simple interface I've proposed, events should be handled either by
       > existing elements (like list items that compare their size and position of dragged element
       > to decide whether element should be dropped before or after) or handled by container that
       > would probably need to calculate positions of it's children and create new element to show
       > drop target. Smooth Mac-like drag'n'drop can be implemented by animating drop target's
       > padding/margin. So that's quite a bit of code that's going to be reinvented each time
       > someone implements reordering.

       <hyatt> :droptarget
       <hyatt> or something
       <hyatt> we don't support a pseudo-class for the drop target but that's a great idea
       <Hixie_> yeah, thinking about that too
       <Hixie_> :drop-target, :drop-target(above), :drop-target(below) and having ondragover be able to say "not on me, but next to me maybe"

       - some way to be able to match an element that is being dragged over.

       - some way to be able to animate an element as it goes into and out of this state (CSS
         transitions?), e.g. to be able to animate something "getting out of the way" to let you
         drop an item between others.

       - as an extension to the previous feature, a way to distinguish being dragged above or to the
         left of the drag target vs below or to the right of the drag target.

     * We should let drop targets communicate back to drag sources if they want to communicate.
       (e.g. expose Window, and thus postMessage(), on the dataTransfer object on drop.) Or maybe
       just use a MessagePort!

       We should let drag sources provide a set of options via a context menu when the drop happens.
       (So that, e.g., the source can know whether a capabilities URI that it is passing along is
       supposed to be read-write access or read-only access to the object being dragged.)

       We should let potential drop targets see the types (but not the contents!) of dragged data so
       they can establish if they care or not. (dataTransfer.hasType())

       Ack: Ben Laurie (@g)

     * Interop with native apps. In particular, we probably want to whitelist the list of types that
       a Web page can see, since otherwise we'll end up exposing things like the username (if a user
       drags a file from their desktop, the path is exposed on some OSes).

     * Alex Velkov suggests that drags to and from the same origin should be able to read the data
       even before the drop.

     Other things listed below:
      DND-v2: more native support: text/html from selections, etc
      DND-v3: add Blob support
      DND-v4: add structured clone support
      DND-v5: add promises (should be able to say "if you accept this
              drop, then I can provide the File object that
              corresponds to it eventually")

         DataTransferPromise.type = 'string' or 'file' or 'blob' or 'data'
                            .onneeddata - can wait until this fires to provide data
                            .setData() - call this once you have data, must be the right type

-->

  <p>This section defines an event-based drag-and-drop mechanism.</p>

  <p>This specification does not define exactly what a <em>drag-and-drop operation</em> actually
  is.</p>

  <p>On a visual medium with a pointing device, a drag operation could be the default action of a
  <code data-anolis-xref="event-mousedown">mousedown</code> event that is followed by a series of <code data-anolis-xref="event-mousemove">mousemove</code> events, and the drop could be triggered by the mouse
  being released.</p>

  <p>When using an input modality other than a pointing device, users would probably have to
  explicitly indicate their intention to perform a drag-and-drop operation, stating what they wish
  to drag and where they wish to drop it, respectively.</p>

  <div class="impl">

  <p>However it is implemented, drag-and-drop operations must have a starting point (e.g. where the
  mouse was clicked, or the start of the selection or element that was selected for the drag), may
  have any number of intermediate steps (elements that the mouse moves over during a drag, or
  elements that the user picks as possible drop points as he cycles through possibilities), and must
  either have an end point (the element above which the mouse button was released, or the element
  that was finally selected), or be canceled. The end point must be the last element selected as a
  possible drop point before the drop occurs (so if the operation is not canceled, there must be at
  least one element in the middle step).</p>

  </div>


  <h4 id="introduction-6"><span class="secno">7.7.1 </span>Introduction</h4>

  <p><i>This section is non-normative.</i></p>
  <p>To make an element draggable is simple: give the element a <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> attribute, and set an event listener for <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> that stores the data being dragged.</p>

  <p>The event handler typically needs to check that it's not a text selection that is being
  dragged, and then needs to store data into the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object and set the
  allowed effects (copy, move, link, or some combination).</p>

  <p>For example:</p>

  <pre>&lt;p&gt;What fruits do you like?&lt;/p&gt;
&lt;ol ondragstart="dragStartHandler(event)"&gt;
 &lt;li draggable="true" data-value="fruit-apple"&gt;Apples&lt;/li&gt;
 &lt;li draggable="true" data-value="fruit-orange"&gt;Oranges&lt;/li&gt;
 &lt;li draggable="true" data-value="fruit-pear"&gt;Pears&lt;/li&gt;
&lt;/ol&gt;
&lt;script&gt;
  var internalDNDType = 'text/x-example'; // set this to something specific to your site
  function dragStartHandler(event) {
    if (event.target instanceof HTMLLIElement) {
      // use the element's data-value="" attribute as the value to be moving:
      event.dataTransfer.setData(internalDNDType, event.target.dataset.value);
      event.dataTransfer.effectAllowed = 'move'; // only allow moves
    } else {
      event.preventDefault(); // don't allow selection to be dragged
    }
  }
&lt;/script&gt;</pre>

  <hr><p>To accept a drop, the drop target has to have a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code>
  attribute and listen to the <code data-anolis-xref="drop-event">drop</code> event.</p>

  <p>The value of the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute specifies what kind of
  data to accept (e.g. "<code data-anolis-xref="">string:text/plain</code>" to accept any text strings, or
  "<code>file:image/png</code>" to accept a PNG image file) and what kind of feedback to give (e.g.
  "<code>move</code>" to indicate that the data will be moved).</p>

  <p class="note">Instead of using the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute, a drop
  target can handle the <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> event (to report whether or
  not the drop target is to accept the drop) and the <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code>
  event (to specify what feedback is to be shown to the user).</p>

  <p>The <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> event allows the actual drop to be performed. This
  event needs to be canceled, so that the <code data-anolis-xref="dom-DataTransfer-DropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attribute's value can be used by the source
  (otherwise it's reset).</p>

  <p>For example:</p>

  <pre>&lt;p&gt;Drop your favorite fruits below:&lt;/p&gt;
&lt;ol dropzone="move string:text/x-example" ondrop="dropHandler(event)"&gt;
 &lt;!-- don't forget to change the "text/x-example" type to something
 specific to your site --&gt;
&lt;/ol&gt;
&lt;script&gt;
  var internalDNDType = 'text/x-example'; // set this to something specific to your site
  function dropHandler(event) {
    var li = document.createElement('li');
    var data = event.dataTransfer.getData(internalDNDType);
    if (data == 'fruit-apple') {
      li.textContent = 'Apples';
    } else if (data == 'fruit-orange') {
      li.textContent = 'Oranges';
    } else if (data == 'fruit-pear') {
      li.textContent = 'Pears';
    } else {
      li.textContent = 'Unknown Fruit';
    }
    event.target.appendChild(li);
  }
&lt;/script&gt;</pre>

  <hr><p>To remove the original element (the one that was dragged) from the display, the <code data-anolis-xref="event-dragend"><a href="editing.html#event-dragend">dragend</a></code> event can be used.</p>

  <p>For our example here, that means updating the original markup to handle that event:</p>

  <pre>&lt;p&gt;What fruits do you like?&lt;/p&gt;
&lt;ol ondragstart="dragStartHandler(event)" ondragend="dragEndHandler(event)"&gt;
 <em>...as before...</em>
&lt;/ol&gt;
&lt;script&gt;
  function dragStartHandler(event) {
    // <em>...as before...</em>
  }
  function dragEndHandler(event) {
    if (event.dataTransfer.dropEffect == 'move') {
      // remove the dragged element
      event.target.parentNode.removeChild(event.target);
    }
  }
&lt;/script&gt;</pre>



  <h4 id="the-drag-data-store"><span class="secno">7.7.2 </span>The drag data store</h4>

  <p>The data that underlies a drag-and-drop operation, known as the <dfn id="drag-data-store">drag data store</dfn>,
  consists of the following information:</p>

  <ul><li><p>A <dfn id="drag-data-store-item-list">drag data store item list</dfn>, which is a list of items representing the dragged
   data, each consisting of the following information:</p>

    <dl><dt><dfn id="the-drag-data-item-kind">The drag data item kind</dfn></dt>

     <dd>

      <p>The kind of data:</p>

      <dl><dt><i>Plain Unicode string</i></dt>
       <dd>
        <p>Text.</p>
       </dd>

<!-- DND-v3:
       <dt><i data-x="">Blob</i></dt>
       <dd>
        <p>Binary data.</p>
       </dd>
-->

       <dt><i data-anolis-xref="">File</i></dt>
       <dd>
        <p>Binary data with a file name.</p>
       </dd>

<!-- DND-v4:
       <dt><i>Structured object</i></dt>
       <dd>
        <p>An object that will be cloned using the <span>structured clone</span> algorithm.</p>
       </dd>
-->

      </dl></dd>

     <dt><dfn id="the-drag-data-item-type-string">The drag data item type string</dfn></dt>

     <dd>

      <p>A Unicode string giving the type or format of the data, generally given by a <a href="infrastructure.html#mime-type">MIME
      type</a>. Some values that are not <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> are
      special-cased for legacy reasons. The API does not enforce the use of <a data-anolis-xref="MIME
      type" href="infrastructure.html#mime-type">MIME types</a>; other values can be used as well. In all cases, however, the values
      are all <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a> by the API.</p>

      <p class="note">Strings that contain <a data-anolis-xref="space character" href="infrastructure.html#space-character">space characters</a>
      cannot be used with the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute, so authors are
      encouraged to use only <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> or custom strings (without
      spaces).</p>

      <p>There is a limit of one <i>Plain Unicode string</i> item per <a data-anolis-xref="The drag data
      item type string" href="editing.html#the-drag-data-item-type-string">item type string</a>.</p> <!-- DND-v4: consider limiting the structured
      objects too -->

     </dd>

     <dt>The actual data</dt>

     <dd><p>A Unicode or binary string, in some cases with a file name (itself a Unicode string),
     <!-- (DND-v4:) or an object, --> as per <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a>.</dd>

    </dl><p>The <a href="editing.html#drag-data-store-item-list">drag data store item list</a> is ordered in the order that the items were added
    to the list; most recently added last.</p>

   </li>

   <li>

    <p>The following information, used to generate the UI feedback during the drag:</p>

    <ul><li>User-agent-defined default feedback information, known as the <dfn id="drag-data-store-default-feedback">drag data store default
     feedback</dfn>.</li>

     <li>Optionally, a bitmap image and the coordinate of a point within that image, known as the
     <dfn id="drag-data-store-bitmap">drag data store bitmap</dfn> and <dfn id="drag-data-store-hot-spot-coordinate">drag data store hot spot coordinate</dfn>.</li>

    </ul></li>

   <li>

    <p>A <dfn id="drag-data-store-mode">drag data store mode</dfn>, which is one of the following:</p>

    <dl><dt><dfn data-anolis-xref="concept-dnd-rw" id="concept-dnd-rw">Read/write mode</dfn></dt>
     <dd>

      <p>For the <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event. New data can be added to the
      <a href="editing.html#drag-data-store">drag data store</a>.</p>

     </dd>

     <dt><dfn data-anolis-xref="concept-dnd-ro" id="concept-dnd-ro">Read-only mode</dfn></dt>
     <dd>

      <p>For the <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> event. The list of items representing dragged
      data can be read, including the data. No new data can be added.</p>

     </dd>

     <dt><dfn data-anolis-xref="concept-dnd-p" id="concept-dnd-p">Protected mode</dfn></dt>
     <dd>

      <p>For all other events. The formats and kinds in the <a href="editing.html#drag-data-store">drag data store</a> list of
      items representing dragged data can be enumerated, but the data itself is unavailable and no
      new data can be added.</p>

     </dd>

    </dl></li>

   <li>

    <p>A <dfn id="drag-data-store-allowed-effects-state">drag data store allowed effects state</dfn>, which is a string.</p>

   </li>

  </ul><p>When a <a href="editing.html#drag-data-store">drag data store</a> is <dfn data-anolis-xref="create a drag data store" id="create-a-drag-data-store">created</dfn>, it
  must be initialized such that its <a href="editing.html#drag-data-store-item-list">drag data store item list</a> is empty, it has no
  <a href="editing.html#drag-data-store-default-feedback">drag data store default feedback</a>, it has no <a href="editing.html#drag-data-store-bitmap">drag data store bitmap</a> and
  <a href="editing.html#drag-data-store-hot-spot-coordinate">drag data store hot spot coordinate</a>, its <a href="editing.html#drag-data-store-mode">drag data store mode</a> is <a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">protected mode</a>, and its <a href="editing.html#drag-data-store-allowed-effects-state">drag data store allowed effects
  state</a> is the string "<code data-anolis-xref="">uninitialized</code>".</p>


  <h4 id="the-datatransfer-interface"><span class="secno">7.7.3 </span>The <code><a href="editing.html#datatransfer">DataTransfer</a></code> interface</h4>

  <p><code><a href="editing.html#datatransfer">DataTransfer</a></code> objects are used to expose the <a href="editing.html#drag-data-store">drag data store</a> that
  underlies a drag-and-drop operation.</p>

  <pre class="idl">interface <dfn id="datatransfer">DataTransfer</dfn> {
           attribute DOMString <a data-anolis-xref="dom-DataTransfer-dropEffect" href="editing.html#dom-datatransfer-dropeffect">dropEffect</a>;
           attribute DOMString <a data-anolis-xref="dom-DataTransfer-effectAllowed" href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a>;

  readonly attribute <a href="editing.html#datatransferitemlist">DataTransferItemList</a> <a data-anolis-xref="dom-DataTransfer-items" href="editing.html#dom-datatransfer-items">items</a>;

  void <a data-anolis-xref="dom-DataTransfer-setDragImage" href="editing.html#dom-datatransfer-setdragimage">setDragImage</a>(Element image, long x, long y);

  /* old interface */
  readonly attribute DOMString[] <a data-anolis-xref="dom-DataTransfer-types" href="editing.html#dom-datatransfer-types">types</a>;
  DOMString <a data-anolis-xref="dom-DataTransfer-getData" href="editing.html#dom-datatransfer-getdata">getData</a>(DOMString format);
  void <a data-anolis-xref="dom-DataTransfer-setData" href="editing.html#dom-datatransfer-setdata">setData</a>(DOMString format, DOMString data);
  void <a data-anolis-xref="dom-DataTransfer-clearData" href="editing.html#dom-datatransfer-cleardata">clearData</a>(optional DOMString format);
  readonly attribute <a href="infrastructure.html#filelist">FileList</a> <a data-anolis-xref="dom-DataTransfer-files" href="editing.html#dom-datatransfer-files">files</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the kind of operation that is currently selected. If the kind of operation isn't one
    of those that is allowed by the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> attribute, then the operation will
    fail.</p>

    <p>Can be set, to change the selected operation.</p>

    <p>The possible values are "<code data-anolis-xref="">none</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">link</code>", and "<code data-anolis-xref="">move</code>".</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the kinds of operations that are to be allowed.</p>

    <p>Can be set (during the <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event), to change the
    allowed operations.</p>

    <p>The possible values are "<code data-anolis-xref="">none</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">copyLink</code>", "<code data-anolis-xref="">copyMove</code>", "<code data-anolis-xref="">link</code>",
    "<code data-anolis-xref="">linkMove</code>", "<code data-anolis-xref="">move</code>", "<code data-anolis-xref="">all</code>", and
    "<code data-anolis-xref="">uninitialized</code>",</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-items"><a href="editing.html#dom-datatransfer-items">items</a></code></dt>

   <dd>

    <p>Returns a <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object, with the drag data.</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-setDragImage"><a href="editing.html#dom-datatransfer-setdragimage">setDragImage</a></code>(<var data-anolis-xref="">element</var>, <var data-anolis-xref="">x</var>, <var data-anolis-xref="">y</var>)</dt>

   <dd>

    <p>Uses the given element to update the drag feedback, replacing any previously specified
    feedback.</p>

   </dd>
   

   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-types"><a href="editing.html#dom-datatransfer-types">types</a></code></dt>

   <dd>

    <p>Returns an array listing the formats that were set in the <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event. In addition, if any files are being dragged,
    then one of the types will be the string "<code data-anolis-xref="">Files</code>".</p>

   </dd>


   <dt><var data-anolis-xref="">data</var> = <var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-getData"><a href="editing.html#dom-datatransfer-getdata">getData</a></code>(<var data-anolis-xref="">format</var>)</dt>

   <dd>

    <p>Returns the specified data. If there is no such data, returns the empty string.</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-setData"><a href="editing.html#dom-datatransfer-setdata">setData</a></code>(<var data-anolis-xref="">format</var>, <var data-anolis-xref="">data</var>)</dt>

   <dd>

    <p>Adds the specified data.</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-clearData"><a href="editing.html#dom-datatransfer-cleardata">clearData</a></code>( [ <var data-anolis-xref="">format</var> ] )</dt>

   <dd>

    <p>Removes the data of the specified formats. Removes all data if the argument is omitted.</p>

   </dd>


   <dt><var data-anolis-xref="">dataTransfer</var> . <code data-anolis-xref="dom-DataTransfer-files"><a href="editing.html#dom-datatransfer-files">files</a></code></dt>

   <dd>

    <p>Returns a <code><a href="infrastructure.html#filelist">FileList</a></code> of the files being dragged, if any.</p>

   </dd>

  </dl><p><code><a href="editing.html#datatransfer">DataTransfer</a></code> objects are used during the <a href="editing.html#dndevents">drag-and-drop
  events</a>, and are only valid while those events are being fired.</p>

  <div class="impl">

  <p>A <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is associated with a <a href="editing.html#drag-data-store">drag data store</a> while it
  is valid.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransfer-dropEffect" id="dom-datatransfer-dropeffect"><code>dropEffect</code></dfn> attribute controls
  the drag-and-drop feedback that the user is given during a drag-and-drop operation. When the
  <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is created, the <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attribute is set to a string value. On
  getting, it must return its current value. On setting, if the new value is one of "<code data-anolis-xref="">none</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">link</code>", or "<code data-anolis-xref="">move</code>", then the attribute's current value must be set to the new value. Other
  values must be ignored.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransfer-effectAllowed" id="dom-datatransfer-effectallowed"><code>effectAllowed</code></dfn> attribute is
  used in the drag-and-drop processing model to initialize the <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attribute during the <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> and <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code> events.
  When the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is created, the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> attribute is set to a string value. On
  getting, it must return its current value. On setting, if <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is the <a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">read/write
  mode</a> and the new value is one of "<code data-anolis-xref="">none</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">copyLink</code>", "<code data-anolis-xref="">copyMove</code>", "<code data-anolis-xref="">link</code>", "<code data-anolis-xref="">linkMove</code>", "<code data-anolis-xref="">move</code>", "<code data-anolis-xref="">all</code>", or "<code data-anolis-xref="">uninitialized</code>", then the attribute's current value
  must be set to the new value. Otherwise it must be left unchanged.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransfer-items" id="dom-datatransfer-items"><code>items</code></dfn> attribute must return a
  <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object associated with the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object. The
  same object must be returned each time.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransfer-setDragImage" id="dom-datatransfer-setdragimage"><code>setDragImage(<var data-anolis-xref="">element</var>,
  <var data-anolis-xref="">x</var>, <var data-anolis-xref="">y</var>)</code></dfn> method must run the following
  steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, abort these steps. Nothing happens.</li>

   <li><p>If the <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is
   not the <a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">read/write mode</a>, abort these steps. Nothing
   happens.</li>

   <li><p>If the <var data-anolis-xref="">element</var> argument is an <code><a href="embedded-content-0.html#the-img-element">img</a></code> element, then set the
   <a href="editing.html#drag-data-store-bitmap">drag data store bitmap</a> to the element's image (at its intrinsic size); otherwise,
   set the <a href="editing.html#drag-data-store-bitmap">drag data store bitmap</a> to an image generated from the given element (the
   exact mechanism for doing so is not currently specified).</li>

   <li><p>Set the <a href="editing.html#drag-data-store-hot-spot-coordinate">drag data store hot spot coordinate</a> to the given <var data-anolis-xref="">x</var>, <var data-anolis-xref="">y</var> coordinate.</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransfer-types" id="dom-datatransfer-types"><code>types</code></dfn> attribute must return a
  <a href="infrastructure.html#live">live</a> <a data-anolis-xref="dfn-read-only-array" href="infrastructure.html#dfn-read-only-array">read only</a> array giving the strings that
  the following steps would produce. The same object must be returned each time.</p>

  <ol><li><p>Start with an empty list <var data-anolis-xref="">L</var>.</li>

   <li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, the array is empty. Abort these steps; return the empty list <var data-anolis-xref="">L</var>.</li>

   <li><p>For each item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> <!-- in some order...? -->
   whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i>, add an
   entry to the list <var data-anolis-xref="">L</var> consisting of the item's <a data-anolis-xref="the drag data item
   type string" href="editing.html#the-drag-data-item-type-string">type string</a>.</li>

   <li><p>If there are any items in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i><a href="infrastructure.html#file">File</a></i>, then add an entry to the list <var data-anolis-xref="">L</var> consisting of the string "<code data-anolis-xref="">Files</code>". (This value can be
   distinguished from the other values because it is not lowercase.)</li>

   <!-- <li><p>Sort the list...?</p></li> -->

   <li><p>The strings produced by these steps are those in the list <var data-anolis-xref="">L</var>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransfer-getData" id="dom-datatransfer-getdata"><code>getData(<var data-anolis-xref="">format</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, return the empty string and abort these steps.</li>

   <li><p>If the <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is
   the <a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">protected mode</a>, return the empty string and abort these
   steps.</li>

   <li><p>Let <var data-anolis-xref="">format</var> be the first argument, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII
   lowercase</a>.</li>

   <li><p>Let <var data-anolis-xref="">convert-to-URL</var> be false.</li>

   <li><p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">text</code>", change it to "<code data-anolis-xref="">text/plain</code>".</li>

   <li><p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">url</code>", change it to "<code data-anolis-xref="">text/uri-list</code>" and set <var data-anolis-xref="">convert-to-URL</var> to true.</li>

   <li><p>If there is no item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the
   drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i> and whose <a data-anolis-xref="the drag
   data item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to <var data-anolis-xref="">format</var>, return the
   empty string and abort these steps.</li>

   <li><p>Let <var data-anolis-xref="">result</var> be the data of the item in the <a href="editing.html#drag-data-store-item-list">drag data store item
   list</a> whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode
   string</i> and whose <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to
   <var data-anolis-xref="">format</var>.</li>

   <li><p>If <var data-anolis-xref="">convert-to-URL</var> is true, then parse <var data-anolis-xref="">result</var> as
   appropriate for <code data-anolis-xref="">text/uri-list</code> data, and then set <var data-anolis-xref="">result</var>
   to the first URL from the list, if any, or the empty string otherwise. <a href="references.html#refsRFC2483">[RFC2483]</a></li>

   <li><p>Return <var data-anolis-xref="">result</var>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransfer-setData" id="dom-datatransfer-setdata"><code>setData(<var data-anolis-xref="">format</var>, <var data-anolis-xref="">data</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, abort these steps. Nothing happens.</li>

   <li><p>If the <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is
   not the <a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">read/write mode</a>, abort these steps. Nothing
   happens.</li>

   <li><p>Let <var data-anolis-xref="">format</var> be the first argument, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII
   lowercase</a>.</li>

   <li>

    <p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">text</code>", change it to "<code data-anolis-xref="">text/plain</code>".</p>

    <p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">url</code>", change it to "<code data-anolis-xref="">text/uri-list</code>".</p>

   </li>

   <li><p>Remove the item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag
   data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i> and whose <a data-anolis-xref="the drag data
   item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to <var data-anolis-xref="">format</var>, if there is
   one.</li>

   <li><p>Add an item to the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag data
   item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i>, whose <a data-anolis-xref="the drag data item type
   string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to <var data-anolis-xref="">format</var>, and whose data is the string
   given by the method's second argument.</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransfer-clearData" id="dom-datatransfer-cleardata"><code>clearData()</code></dfn> method must run the
  following steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, abort these steps. Nothing happens.</li>

   <li><p>If the <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is
   not the <a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">read/write mode</a>, abort these steps. Nothing
   happens.</li>

   <li><p>If the method was called with no arguments, remove each item in the <a href="editing.html#drag-data-store-item-list">drag data store
   item list</a> whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode
   string</i>, and abort these steps.</li>

   <li><p>Let <var data-anolis-xref="">format</var> be the first argument, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII
   lowercase</a>.</li>

   <li>

    <p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">text</code>", change it to "<code data-anolis-xref="">text/plain</code>".</p>

    <p>If <var data-anolis-xref="">format</var> equals "<code data-anolis-xref="">url</code>", change it to "<code data-anolis-xref="">text/uri-list</code>".</p>

   </li>

   <li><p>Remove the item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag
   data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i> and whose <a data-anolis-xref="the drag data
   item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to <var data-anolis-xref="">format</var>, if there is
   one.</li>

  </ol><p class="note">The <code data-anolis-xref="dom-DataTransfer-clearData"><a href="editing.html#dom-datatransfer-cleardata">clearData()</a></code> method does not
  affect whether any files were included in the drag, so the <code data-anolis-xref="dom-DataTransfer-types"><a href="editing.html#dom-datatransfer-types">types</a></code> attribute's list might still not be empty after
  calling <code data-anolis-xref="dom-DataTransfer-clearData"><a href="editing.html#dom-datatransfer-cleardata">clearData()</a></code> (it would still contain the
  "<code data-anolis-xref="">Files</code>" string if any files were included in the drag).</p>

  <p>The <dfn data-anolis-xref="dom-DataTransfer-files" id="dom-datatransfer-files"><code>files</code></dfn> attribute must return a
  <a href="infrastructure.html#live">live</a> <code><a href="infrastructure.html#filelist">FileList</a></code> sequence consisting of <code><a href="infrastructure.html#file">File</a></code> objects
  representing the files found by the following steps. The same object must be returned each time.
  Furthermore, for a given <code><a href="infrastructure.html#filelist">FileList</a></code> object and a given underlying file, the same
  <code><a href="infrastructure.html#file">File</a></code> object must be used each time.</p>

  <ol><li><p>Start with an empty list <var data-anolis-xref="">L</var>.</li>

   <li><p>If the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is no longer associated with a <a href="editing.html#drag-data-store">drag data
   store</a>, the <code><a href="infrastructure.html#filelist">FileList</a></code> is empty. Abort these steps; return the empty list <var data-anolis-xref="">L</var>.</li>

   <li><p>If the <a href="editing.html#drag-data-store">drag data store</a>'s <a data-anolis-xref="drag data store mode" href="editing.html#drag-data-store-mode">mode</a> is
   the <a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">protected mode</a>, abort these steps; return the empty list
   <var data-anolis-xref="">L</var>.</li>

   <li><p>For each item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> <!-- in some order...? -->
   whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i><a href="infrastructure.html#file">File</a></i> <!-- DND-v3: (not
   <i>Blob</i>) -->, add the item's data (the file, in particular its name and contents, as well as
   its <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">type</a>) to the list <var data-anolis-xref="">L</var>.</li>

   <!-- <li><p>Sort the list...?</p></li> -->

   <li><p>The files found by these steps are those in the list <var data-anolis-xref="">L</var>.</li>

  </ol><p class="note">This version of the API does not expose the types of the files during the
  drag.</p>

  </div>


  <h5 id="the-datatransferitemlist-interface"><span class="secno">7.7.3.1 </span>The <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> interface</h5>

  <p>Each <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is associated with a <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code>
  object.</p>

  <pre class="idl">interface <dfn id="datatransferitemlist">DataTransferItemList</dfn> {
  readonly attribute unsigned long <a data-anolis-xref="dom-DataTransferItemList-length" href="editing.html#dom-datatransferitemlist-length">length</a>;
  <a data-anolis-xref="dom-DataTransferItemList-item" href="editing.html#dom-datatransferitemlist-item">getter</a> <a href="editing.html#datatransferitem">DataTransferItem</a> (unsigned long index);
  <a href="editing.html#datatransferitem">DataTransferItem</a>? <a data-anolis-xref="dom-DataTransferItemList-add" href="editing.html#dom-datatransferitemlist-add">add</a>(DOMString data, DOMString type);<!--
DND-v3:  <span>DataTransferItem</span>? <span data-x="dom-DataTransferItemList-add">add</span>(<span>Blob</span> data);-->
  <a href="editing.html#datatransferitem">DataTransferItem</a>? <a data-anolis-xref="dom-DataTransferItemList-add" href="editing.html#dom-datatransferitemlist-add">add</a>(<a href="infrastructure.html#file">File</a> data);<!--
DND-v4:  <span>DataTransferItem</span>? <span data-x="dom-DataTransferItemList-add">add</span>(any data, DOMString type);--><!--
DND-v5:  <span>DataTransferItem</span>? <span data-x="dom-DataTransferItemList-add">add</span>(<span>DataTransferPromise</span> data);-->
  void <a data-anolis-xref="dom-DataTransferItemList-remove" href="editing.html#dom-datatransferitemlist-remove">remove</a>(unsigned long index);
  void <a data-anolis-xref="dom-DataTransferItemList-clear" href="editing.html#dom-datatransferitemlist-clear">clear</a>();
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">items</var> . <code data-anolis-xref="dom-DataTransferItemList-length"><a href="editing.html#dom-datatransferitemlist-length">length</a></code></dt>

   <dd><p>Returns the number of items in the <a href="editing.html#drag-data-store">drag data store</a>.</dd>


   <dt><var data-anolis-xref="">items</var>[<var data-anolis-xref="">index</var>]</dt>

   <dd>

    <p>Returns the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object representing the <var data-anolis-xref="">index</var>th
    entry in the <a href="editing.html#drag-data-store">drag data store</a>.</p>

   </dd>


   <dt><var data-anolis-xref="">items</var> . <code data-anolis-xref="dom-DataTransferItemList-remove"><a href="editing.html#dom-datatransferitemlist-remove">remove</a></code>(<var data-anolis-xref="">index</var>)</dt>

   <dd>

    <p>Removes the <var data-anolis-xref="">index</var>th entry in the <a href="editing.html#drag-data-store">drag data store</a>.</p>

   </dd>


   <dt><var data-anolis-xref="">items</var> . <code data-anolis-xref="dom-DataTransferItemList-clear"><a href="editing.html#dom-datatransferitemlist-clear">clear</a></code>()</dt>

   <dd>

    <p>Removes all the entries in the <a href="editing.html#drag-data-store">drag data store</a>.</p>

   </dd>


   <dt><var data-anolis-xref="">items</var> . <code data-anolis-xref="dom-DataTransferItemList-add"><a href="editing.html#dom-datatransferitemlist-add">add</a></code>(<var data-anolis-xref="">data</var>)</dt>
   <dt><var data-anolis-xref="">items</var> . <code data-anolis-xref="dom-DataTransferItemList-add"><a href="editing.html#dom-datatransferitemlist-add">add</a></code>(<var data-anolis-xref="">data</var>, <var data-anolis-xref="">type</var>)</dt>

   <dd>

    <p>Adds a new entry for the given data to the <a href="editing.html#drag-data-store">drag data store</a>. If the data is plain
    text <!-- DND-v4: or an object --> then a <var data-anolis-xref="">type</var> string has to be provided
    also.</p>

   </dd>

  </dl><div class="impl">

  <p>While the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is
  associated with a <a href="editing.html#drag-data-store">drag data store</a>, the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object's
  <i>mode</i> is the same as the <a href="editing.html#drag-data-store-mode">drag data store mode</a>. When the
  <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is <em>not</em>
  associated with a <a href="editing.html#drag-data-store">drag data store</a>, the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object's
  <i>mode</i> is the <i>disabled mode</i>. The <a href="editing.html#drag-data-store">drag data store</a> referenced in this
  section (which is used only when the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object is not in the
  <i>disabled mode</i>) is the <a href="editing.html#drag-data-store">drag data store</a> with which the
  <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is associated.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransferItemList-length" id="dom-datatransferitemlist-length"><code>length</code></dfn> attribute must
  return zero if the object is in the <i>disabled mode</i>; otherwise it must return the number of
  items in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a>.</p>

  <p>When a <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object is not in the <i>disabled mode</i>, its
  <a href="infrastructure.html#supported-property-indices">supported property indices</a> are the numbers in the range

    <span data-anolis-xref="">0 .. <var data-anolis-xref="">n</var>-1</span>,

  where <var data-anolis-xref="">n</var> is the number of items in the <a href="editing.html#drag-data-store-item-list">drag data store item
  list</a>.</p>

  <p>To <dfn data-anolis-xref="dom-DataTransferItemList-item" id="dom-datatransferitemlist-item">determine the value of an indexed property</dfn>
  <var data-anolis-xref="">i</var> of a <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object, the user agent must return a
  <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object representing the <var data-anolis-xref="">i</var>th item in the
  <a href="editing.html#drag-data-store">drag data store</a>. The same object must be returned each time a particular item is
  obtained from this <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object. The <code><a href="editing.html#datatransferitem">DataTransferItem</a></code>
  object must be associated with the same <code><a href="editing.html#datatransfer">DataTransfer</a></code> object as the
  <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object when it is first created.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransferItemList-add" id="dom-datatransferitemlist-add"><code>add()</code></dfn> method must run the
  following steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object is not in the <i data-anolis-xref="concept-dnd-rw"><a href="editing.html#concept-dnd-rw">read/write mode</a></i>, return null and abort these steps.</li>

   <li>

    <p>Jump to the appropriate set of steps from the following list:</p>

    <dl class="switch"><dt>If the first argument to the method is a string</dt>

     <dd>

      <p>If there is already an item in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i> and whose <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to the value of the
      method's second argument, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a>, then throw a
      <code><a href="infrastructure.html#notsupportederror">NotSupportedError</a></code> exception and abort these steps.</p>

      <p>Otherwise, add an item to the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the
      drag data item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i>Plain Unicode string</i>, whose <a data-anolis-xref="the drag
      data item type string" href="editing.html#the-drag-data-item-type-string">type string</a> is equal to the value of the method's second
      argument, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a>, and whose data is the string given by the
      method's first argument.</p>

     </dd>

<!--DND-v3:
     <dt>If the first argument to the method is a <code>Blob</code></dt>

     <dd>

      <p>Add an item to the <span>drag data store item list</span> whose <span data-x="the drag data
      item kind">kind</span> is <i>Blob</i>, whose <span data-x="the drag data item type string">type
      string</span> is the <code data-x="dom-Blob-type">type</code> of the <code>Blob</code>,
      <span>converted to ASCII lowercase</span>, and whose data is the same as the
      <code>Blob</code>'s data.</p>

     </dd>
-->

     <dt>If the first argument to the method is a <code><a href="infrastructure.html#file">File</a></code></dt>

     <dd>

      <p>Add an item to the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag data
      item kind" href="editing.html#the-drag-data-item-kind">kind</a> is <i><a href="infrastructure.html#file">File</a></i>, whose <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">type
      string</a> is the <code data-anolis-xref="dom-Blob-type"><a href="infrastructure.html#dom-blob-type">type</a></code> of the <code><a href="infrastructure.html#file">File</a></code>,
      <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a>, and whose data is the same as the
      <code><a href="infrastructure.html#file">File</a></code>'s data.</p>

     </dd>

<!--DND-v4: (might want to prevent duplicates like for strings; see above)
[make sure that the cloning happens before any side-effects can happen]
     <dt>Otherwise

     <dd>

      <p>Add an item to the <span>drag data store item list</span> whose <span data-x="the drag data
      item kind">kind</span> is <i>Object</i>, whose <span data-x="the drag data item type
      string">type string</span> is equal to the value of the method's second argument,
      <span>converted to ASCII lowercase</span>, and whose data is a <span>structured clone</span>
      of the method's first argument. If creating the clone throws an exception, then throw that
      exception and abort these steps.</p>

     </dd>
-->

    </dl></li>

   <li><p><a data-anolis-xref="dom-DataTransferItemList-item" href="editing.html#dom-datatransferitemlist-item">Determine the value of the indexed
   property</a> corresponding to the newly added item, and return that value (a newly created
   <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object).</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransferItemList-remove" id="dom-datatransferitemlist-remove"><code>remove()</code></dfn> method, when
  invoked with the argument <var data-anolis-xref="">i</var>, must run these steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object is not in the <i data-anolis-xref="concept-dnd-rw"><a href="editing.html#concept-dnd-rw">read/write mode</a></i>, throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception and
   abort these steps.</li>

   <li><p>Remove the <var data-anolis-xref="">i</var>th item from the <a href="editing.html#drag-data-store">drag data store</a>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-DataTransferItemList-clear" id="dom-datatransferitemlist-clear"><code>clear</code></dfn> method, if the
  <code><a href="editing.html#datatransferitemlist">DataTransferItemList</a></code> object is in the <i data-anolis-xref="concept-dnd-rw"><a href="editing.html#concept-dnd-rw">read/write mode</a></i>,
  must remove all the items from the <a href="editing.html#drag-data-store">drag data store</a>. Otherwise, it must do
  nothing.</p>

  </div>


  <h5 id="the-datatransferitem-interface"><span class="secno">7.7.3.2 </span>The <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> interface</h5>

  <p>Each <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is associated with a <code><a href="editing.html#datatransfer">DataTransfer</a></code>
  object.</p>

  <pre class="idl">interface <dfn id="datatransferitem">DataTransferItem</dfn> {
  readonly attribute DOMString <a data-anolis-xref="dom-DataTransferItem-kind" href="editing.html#dom-datatransferitem-kind">kind</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-DataTransferItem-type" href="editing.html#dom-datatransferitem-type">type</a>;
  void <a data-anolis-xref="dom-DataTransferItem-getAsString" href="editing.html#dom-datatransferitem-getasstring">getAsString</a>(<a href="editing.html#functionstringcallback">FunctionStringCallback</a>? _callback);<!--
DND-v3:  <span>Blob</span> <span data-x="dom-DataTransferItem-getAsBlob">getAsBlob</span>();-->
  <a href="infrastructure.html#file">File</a>? <a data-anolis-xref="dom-DataTransferItem-getAsFile" href="editing.html#dom-datatransferitem-getasfile">getAsFile</a>();<!--
DND-v4:  void <span data-x="dom-DataTransferItem-getAsObject">getAsObject</span>(<span>FunctionObjectCallback</span> _callback);-->
};

callback <dfn id="functionstringcallback">FunctionStringCallback</dfn> = void (DOMString data);<!--

// DND-v4:
callback <dfn>FunctionObjectCallback</dfn> = void (any data);--></pre>

  <dl class="domintro"><dt><var data-anolis-xref="">item</var> . <code data-anolis-xref="dom-DataTransferItem-kind"><a href="editing.html#dom-datatransferitem-kind">kind</a></code></dt>
   <dd>

    <p>Returns <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a>, one of: "string",
    <!-- DND-v3: "blob", --> "file"<!-- DND-v4: , "object" -->.</p>

   </dd>

   <dt><var data-anolis-xref="">item</var> . <code data-anolis-xref="dom-DataTransferItem-type"><a href="editing.html#dom-datatransferitem-type">type</a></code></dt>
   <dd>

    <p>Returns <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">item</var> . <code data-anolis-xref="dom-DataTransferItem-getAsString"><a href="editing.html#dom-datatransferitem-getasstring">getAsString</a></code>(<var data-anolis-xref="">callback</var>)</dt>
   <dd>

    <p>Invokes the callback with the string data as the argument, if <a href="editing.html#the-drag-data-item-kind">the drag data item
    kind</a> is <i>Plain Unicode string</i>.</p>

   </dd>

<!-- DND-v3:
   <dt><var data-x="">file</var> = <var data-x="">item</var> . <code data-x="dom-DataTransferItem-getAsBlob">getAsBlob</code>()</dt>
   <dd>

    <p>Returns a <code>Blob</code> object, if <span>the drag data item kind</span> is <i>Blob</i> or <i>File</i>.</p>

   </dd>
-->

   <dt><var data-anolis-xref="">file</var> = <var data-anolis-xref="">item</var> . <code data-anolis-xref="dom-DataTransferItem-getAsFile"><a href="editing.html#dom-datatransferitem-getasfile">getAsFile</a></code>()</dt>
   <dd>

    <p>Returns a <code><a href="infrastructure.html#file">File</a></code> object, if <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> is <i><a href="infrastructure.html#file">File</a></i>.</p>

   </dd>

<!-- DND-v4:
   <dt><var data-x="">file</var> = <var data-x="">item</var> . <code data-x="dom-DataTransferItem-getAsObject">getAsObject</code>()</dt>
   <dd>

    <p>Invokes the callback with the cloned object data as the argument, if <span>the drag data item
    kind</span> is <i>Plain Unicode string</i> or <i>Object</i>.</p>

   </dd>
-->

  </dl><div class="impl">

  <p>While the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is associated
  with a <a href="editing.html#drag-data-store">drag data store</a> and that <a href="editing.html#drag-data-store">drag data store</a>'s <a href="editing.html#drag-data-store-item-list">drag data store
  item list</a> still contains the item that the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object represents,
  the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object's <i>mode</i> is the same as the <a href="editing.html#drag-data-store-mode">drag data store
  mode</a>. When the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code> object is
  <em>not</em> associated with a <a href="editing.html#drag-data-store">drag data store</a>, or if the item that the
  <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object represents has been removed from the relevant <a href="editing.html#drag-data-store-item-list">drag data
  store item list</a>, the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object's <i>mode</i> is the <i>disabled
  mode</i>. The <a href="editing.html#drag-data-store">drag data store</a> referenced in this section (which is used only when the
  <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is not in the <i>disabled mode</i>) is the <a href="editing.html#drag-data-store">drag data
  store</a> with which the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object's <code><a href="editing.html#datatransfer">DataTransfer</a></code>
  object is associated.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransferItem-kind" id="dom-datatransferitem-kind"><code>kind</code></dfn> attribute must return the
  empty string if the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is in the <i>disabled mode</i>; otherwise
  it must return the string given in the cell from the second column of the following table from the
  row whose cell in the first column contains <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> of the item
  represented by the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object:</p>

  <table><thead><tr><th> Kind <th> String
   <tbody><tr><td> <i>Plain Unicode string</i> <td> "<code data-anolis-xref="">string</code>"
<!-- DND-v3:    <tr> <td> <i>Blob</i> <td> "<code data-x="">blob</code>"-->
    <tr><td> <i><a href="infrastructure.html#file">File</a></i> <td> "<code data-anolis-xref="">file</code>"
<!-- DND-v4:    <tr> <td> <i>Object</i> <td> "<code data-x="">object</code>"-->
  </table><p>The <dfn data-anolis-xref="dom-DataTransferItem-type" id="dom-datatransferitem-type"><code>type</code></dfn> attribute must return the
  empty string if the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is in the <i>disabled mode</i>; otherwise
  it must return <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a> of the item represented by the
  <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-DataTransferItem-getAsString" id="dom-datatransferitem-getasstring"><code>getAsString(<var data-anolis-xref="">callback</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>If the <var data-anolis-xref="">callback</var> is null, abort these steps.</li>

   <li><p>If the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is not in the <i data-anolis-xref="concept-dnd-rw"><a href="editing.html#concept-dnd-rw">read/write mode</a></i> or the <i data-anolis-xref="concept-dnd-ro"><a href="editing.html#concept-dnd-ro">read-only mode</a></i>,
   abort these steps. The callback is never invoked.</li>

   <li><p>If <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> is not <i>Plain Unicode string</i>, abort these
   steps. The callback is never invoked.</li>

   <li><p>Otherwise, <a href="webappapis.html#queue-a-task">queue a task</a> to invoke <var data-anolis-xref="">callback</var>, passing the
   actual data of the item represented by the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object as the
   argument.</li>

  </ol><!--DND-v3:
  <p>The <dfn data-x="dom-DataTransferItem-getAsBlob"><code>getAsBlob()</code></dfn> method must run
  the following steps:</p>

  <ol>

   <li><p>If the <code>DataTransferItem</code> object is not in the <i
   data-x="concept-dnd-rw">read/write mode</i> or the <i data-x="concept-dnd-ro">read-only mode</i>,
   return null and abort these steps.</p></li>

   <li>

--><!--DND-v4:
    <p>If <span>the drag data item kind</span> is <i>Object</i>, return null.</p></li>
--><!--DND-v3:

    <p>If <span>the drag data item kind</span> is <i>File</i>, then return a new <code>File</code>
    object representing the actual data of the item represented by the <code>DataTransferItem</code>
    object.</p>

    <p>If <span>the drag data item kind</span> is <i>Unicode Data string</i>, then return a new
    <code>Blob</code> object representing the actual data of the item represented by the
    <code>DataTransferItem</code> object, with the <code data-x="dom-Blob-type">type</code> of the
    <code>Blob</code> being <span>the drag data item type string</span> and with the binary data of
    the <code>Blob</code> object being the Unicode string encoded as UTF-8. <a
    href="#refsRFC3629">[RFC3629]</a></p>

    <p>Otherwise, <span>the drag data item kind</span> is <i>Blob</i>; return a new
    <code>Blob</code> object representing the actual data of the item represented by the
    <code>DataTransferItem</code> object.</p>

   </li>

  </ol>
--><p>The <dfn data-anolis-xref="dom-DataTransferItem-getAsFile" id="dom-datatransferitem-getasfile"><code>getAsFile()</code></dfn>
  method must run the following steps:</p>

  <ol><li><p>If the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object is not in the <i data-anolis-xref="concept-dnd-rw"><a href="editing.html#concept-dnd-rw">read/write mode</a></i> or the <i data-anolis-xref="concept-dnd-ro"><a href="editing.html#concept-dnd-ro">read-only mode</a></i>,
   return null and abort these steps.</li>

   <li><p>If <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> is not <i><a href="infrastructure.html#file">File</a></i>, then return null and abort
   these steps.</li>

   <li><p>Return a new <code><a href="infrastructure.html#file">File</a></code> object representing the actual data of the item represented
   by the <code><a href="editing.html#datatransferitem">DataTransferItem</a></code> object.</p>

  </ol><!--DND-v4:
  <p>The <dfn data-x="dom-DataTransferItem-getAsObject"><code>getAsObject(<var
  data-x="">callback</var>)</code></dfn> method must run the following steps:</p>

  <ol>

   <li><p>If the <code>DataTransferItem</code> object is not in the <i
   data-x="concept-dnd-rw">read/write mode</i> or the <i data-x="concept-dnd-ro">read-only mode</i>,
   return null and abort these steps.</p></li>

   <li>

    <p>Let <var data-x="">data</var> be the actual data of the item represented by the
    <code>DataTransferItem</code> object.</p>

    <p>If <span>the drag data item kind</span> is <i>Unicode Data string</i>, then <var
    data-x="">data</var> is a <code data-x="">DOMString</code> containing the actual data.</p>

    <p>If <span>the drag data item kind</span> is <i>Blob</i>, then <var data-x="">data</var> is a
    <code>Blob</code> representing the actual data.</p>

    <p>If <span>the drag data item kind</span> is <i>File</i>, then <var data-x="">data</var> is a
    <code>File</code> representing the actual data.</p>

    <p>If <span>the drag data item kind</span> is <i>Object</i>, then <var data-x="">data</var> is
    the object that is the actual data.</p>

   </li>

   <li><span>Queue a task</span> to invoke <var data-x="">callback</var>, passing a <span>structured
   clone</span> of <var data-x="">data</var> as the argument.</p></li>

  </ol>
--></div>



  <h4 id="the-dragevent-interface"><span class="secno">7.7.4 </span>The <code><a href="editing.html#dragevent">DragEvent</a></code> interface</h4>

  <p>The drag-and-drop processing model involves several events. They all use the
  <code><a href="editing.html#dragevent">DragEvent</a></code> interface.</p>

  <pre class="idl">[Constructor(DOMString type, optional <a href="editing.html#drageventinit">DragEventInit</a> eventInitDict)]
interface <dfn id="dragevent">DragEvent</dfn> : <a href="infrastructure.html#mouseevent">MouseEvent</a> {
  readonly attribute <a href="editing.html#datatransfer">DataTransfer</a>? <a data-anolis-xref="dom-DragEvent-dataTransfer" href="editing.html#dom-dragevent-datatransfer">dataTransfer</a>;
};

dictionary <dfn id="drageventinit">DragEventInit</dfn> : <a href="infrastructure.html#mouseeventinit">MouseEventInit</a> {
  <a href="editing.html#datatransfer">DataTransfer</a>? dataTransfer;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">event</var> . <code data-anolis-xref="dom-DragEvent-dataTransfer"><a href="editing.html#dom-dragevent-datatransfer">dataTransfer</a></code></dt>

   <dd>

    <p>Returns the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object for the event.</p>

   </dd>

  </dl><p class="note">Although, for consistency with other event interfaces, the <code><a href="editing.html#dragevent">DragEvent</a></code>
  interface has a constructor, it is not particularly useful. In particular, there's no way to
  create a useful <code><a href="editing.html#datatransfer">DataTransfer</a></code> object from script, as <code><a href="editing.html#datatransfer">DataTransfer</a></code> objects
  have a processing and security model that is coordinated by the browser during drag-and-drops.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-DragEvent-dataTransfer" id="dom-dragevent-datatransfer"><code>dataTransfer</code></dfn> attribute of the
  <code><a href="editing.html#dragevent">DragEvent</a></code> interface must return the value it was initialized to. When the object is
  created, this attribute must be initialized to null. It represents the context information for the
  event.</p>

  </div>

  <div class="impl">

  <p>When a user agent is required to <dfn id="fire-a-dnd-event">fire a DND event</dfn> named <var data-anolis-xref="">e</var> at an
  element, using a particular <a href="editing.html#drag-data-store">drag data store</a>, the user agent must run the following
  steps:</p>

  <ol><li>

    <p>If <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code>, set the
    <a href="editing.html#drag-data-store-mode">drag data store mode</a> to the <a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">read/write
    mode</a>.</p>

    <p>If <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code>, set the <a href="editing.html#drag-data-store-mode">drag data
    store mode</a> to the <a data-anolis-xref="concept-dnd-ro" href="editing.html#concept-dnd-ro">read-only mode</a>.</p>

   </li>

   <li><p>Let <var data-anolis-xref="">dataTransfer</var> be a newly created <code><a href="editing.html#datatransfer">DataTransfer</a></code> object
   associated with the given <a href="editing.html#drag-data-store">drag data store</a>.</li>

   <li><p id="effectAllowed-initialization">Set the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> attribute to the <a href="editing.html#drag-data-store">drag data
   store</a>'s <a href="editing.html#drag-data-store-allowed-effects-state">drag data store allowed effects state</a>.</li>

   <li>

    <p id="dropEffect-initialization">Set the <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attribute to "<code data-anolis-xref="">none</code>"
    if <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code>, <code data-anolis-xref="event-drag"><a href="editing.html#event-drag">drag</a></code>, <code data-anolis-xref="event-dragexit"><a href="editing.html#event-dragexit">dragexit</a></code>, or <code data-anolis-xref="event-dragleave"><a href="editing.html#event-dragleave">dragleave</a></code>; to the value corresponding to the <a href="editing.html#current-drag-operation">current drag
    operation</a> if <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> or <code data-anolis-xref="event-dragend"><a href="editing.html#event-dragend">dragend</a></code>; and to a value based on the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> attribute's value and the
    drag-and-drop source, as given by the following table, otherwise (i.e. if <var data-anolis-xref="">e</var>
    is <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> or <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code>):</p>

    <table><thead><tr><th><code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code></th>
       <th><code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code></th>
      <tbody><tr><td>"<code data-anolis-xref="">none</code>"</td>
      <td>"<code data-anolis-xref="">none</code>"</td>
     <tr><td>"<code data-anolis-xref="">copy</code>"</td>
      <td>"<code data-anolis-xref="">copy</code>"</td>
     <tr><td>"<code data-anolis-xref="">copyLink</code>"</td>
      <td>"<code data-anolis-xref="">copy</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, "<code data-anolis-xref="">link</code>"</td>
     <tr><td>"<code data-anolis-xref="">copyMove</code>"</td>
      <td>"<code data-anolis-xref="">copy</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, "<code data-anolis-xref="">move</code>"</td>
     <tr><td>"<code data-anolis-xref="">all</code>"</td>
      <td>"<code data-anolis-xref="">copy</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, either "<code data-anolis-xref="">link</code>" or "<code data-anolis-xref="">move</code>"</td>
     <tr><td>"<code data-anolis-xref="">link</code>"</td>
      <td>"<code data-anolis-xref="">link</code>"</td>
     <tr><td>"<code data-anolis-xref="">linkMove</code>"</td>
      <td>"<code data-anolis-xref="">link</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, "<code data-anolis-xref="">move</code>"</td>
     <tr><td>"<code data-anolis-xref="">move</code>"</td>
      <td>"<code data-anolis-xref="">move</code>"</td>
     <tr><td>"<code data-anolis-xref="">uninitialized</code>" when what is being dragged is a selection from a text field</td>
      <td>"<code data-anolis-xref="">move</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, either "<code data-anolis-xref="">copy</code>" or "<code data-anolis-xref="">link</code>"</td>
     <tr><td>"<code data-anolis-xref="">uninitialized</code>" when what is being dragged is a selection</td>
      <td>"<code data-anolis-xref="">copy</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, either "<code data-anolis-xref="">link</code>" or "<code data-anolis-xref="">move</code>"</td>
     <tr><td>"<code data-anolis-xref="">uninitialized</code>" when what is being dragged is an <code><a href="text-level-semantics.html#the-a-element">a</a></code> element with an <code>href</code> attribute</td>
      <td>"<code data-anolis-xref="">link</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, either "<code data-anolis-xref="">copy</code>" or "<code data-anolis-xref="">move</code>"</td>
     <tr><td>Any other case</td>
      <td>"<code data-anolis-xref="">copy</code>", or, <a data-anolis-xref="concept-platform-dropEffect-override" href="editing.html#concept-platform-dropeffect-override">if appropriate</a>, either "<code data-anolis-xref="">link</code>" or "<code data-anolis-xref="">move</code>"</td>
     </table><p>Where the table above provides <dfn data-anolis-xref="concept-platform-dropEffect-override" id="concept-platform-dropeffect-override">possibly
    appropriate alternatives</dfn>, user agents may instead use the listed alternative values if
    platform conventions dictate that the user has requested those alternate effects.</p>

    <p class="example">For example, Windows platform conventions are such that dragging while
    holding the "alt" key indicates a preference for linking the data, rather than moving or copying
    it. Therefore, on a Windows system, if "<code data-anolis-xref="">link</code>" is an option according to
    the table above while the "alt" key is depressed, the user agent could select that instead of
    "<code data-anolis-xref="">copy</code>" or "<code data-anolis-xref="">move</code>".</p>

   </li>

   <li>

    <p>Create a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> <code><a href="editing.html#dragevent">DragEvent</a></code> object
    and initialize it to have the given name <var data-anolis-xref="">e</var>, to bubble, to be cancelable
    unless <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-dragexit"><a href="editing.html#event-dragexit">dragexit</a></code>, <code data-anolis-xref="event-dragleave"><a href="editing.html#event-dragleave">dragleave</a></code>, or <code data-anolis-xref="event-dragend"><a href="editing.html#event-dragend">dragend</a></code>, and to
    have the <code data-anolis-xref="dom-UIEvent-detail"><a href="infrastructure.html#dom-uievent-detail">detail</a></code> attribute initialized to zero, the mouse
    and key attributes initialized according to the state of the input devices as they would be for
    user interaction events, the <code data-anolis-xref="">relatedTarget</code> attribute initialized to null,
    and the <code data-anolis-xref="dom-DragEvent-dataTransfer"><a href="editing.html#dom-dragevent-datatransfer">dataTransfer</a></code> attribute initialized to
    <var data-anolis-xref="">dataTransfer</var>, the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object created above.</p>

    <!-- interaction event spec point -->

    <p>If there is no relevant pointing device, the object must have its <code data-anolis-xref="">screenX</code>, <code data-anolis-xref="">screenY</code>, <code data-anolis-xref="">clientX</code>, <code data-anolis-xref="">clientY</code>, and <code data-anolis-xref="">button</code> attributes set to 0.</p>

   </li>

   <li><p><a data-anolis-xref="concept-event-dispatch" href="infrastructure.html#concept-event-dispatch">Dispatch</a> the newly created
   <code><a href="editing.html#dragevent">DragEvent</a></code> object at the specified target element.</li>

   <li><p>Set the <a href="editing.html#drag-data-store-allowed-effects-state">drag data store allowed effects state</a> to the current value of <var data-anolis-xref="">dataTransfer</var>'s <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code>
   attribute. (It can only have changed value if <var data-anolis-xref="">e</var> is <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code>.)</li>

   <li><p>Set the <a href="editing.html#drag-data-store-mode">drag data store mode</a> back to the <a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">protected mode</a> if it was changed in the first step.</li>

   <li><p>Break the association between <var data-anolis-xref="">dataTransfer</var> and the <a href="editing.html#drag-data-store">drag data
   store</a>.</li>

  </ol></div>


  <div class="impl">

  <h4 id="drag-and-drop-processing-model"><span class="secno">7.7.5 </span>Drag-and-drop processing model</h4>

  <p>When the user attempts to begin a drag operation, the user agent must run the following steps.
  User agents must act as if these steps were run even if the drag actually started in another
  document or application and the user agent was not aware that the drag was occurring until it
  intersected with a document under the user agent's purview.</p>

  <ol><li>

    <p>Determine what is being dragged, as follows:</p>

    <p>If the drag operation was invoked on a selection, then it is the selection that is being
    dragged.</p>

    <p>Otherwise, if the drag operation was invoked on a <code><a href="dom.html#document">Document</a></code>, it is the first
    element, going up the ancestor chain, starting at the node that the user tried to drag, that has
    the IDL attribute <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> set to true. If there is no such
    element, then nothing is being dragged; abort these steps, the drag-and-drop operation is never
    started.</p>

    <p>Otherwise, the drag operation was invoked outside the user agent's purview. What is being
    dragged is defined by the document or application where the drag was started.</p>

    <p class="note"><code><a href="embedded-content-0.html#the-img-element">img</a></code> elements and <code><a href="text-level-semantics.html#the-a-element">a</a></code> elements with an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute have their <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> attribute set to true by default.</p>

   </li>

   <li><p><a href="editing.html#create-a-drag-data-store">Create a drag data store</a>. All the DND events fired subsequently by the steps
   in this section must use this <a href="editing.html#drag-data-store">drag data store</a>.</li>

   <li>

    <p>Establish which DOM node is the <dfn id="source-node">source node</dfn>, as follows:</p>

    <p>If it is a selection that is being dragged, then the <a href="editing.html#source-node">source node</a> is the
    <code><a href="infrastructure.html#text-0">Text</a></code> node that the user started the drag on (typically the <code><a href="infrastructure.html#text-0">Text</a></code> node
    that the user originally clicked). If the user did not specify a particular node, for example if
    the user just told the user agent to begin a drag of "the selection", then the <a href="editing.html#source-node">source
    node</a> is the first <code><a href="infrastructure.html#text-0">Text</a></code> node containing a part of the selection.</p>

    <p>Otherwise, if it is an element that is being dragged, then the <a href="editing.html#source-node">source node</a> is
    the element that is being dragged.</p>

    <p>Otherwise, the <a href="editing.html#source-node">source node</a> is part of another document or application. When this
    specification requires that an event be dispatched at the <a href="editing.html#source-node">source node</a> in this case,
    the user agent must instead follow the platform-specific conventions relevant to that
    situation.</p>

    <p class="note">Multiple events are fired on the <a href="editing.html#source-node">source node</a> during the course of
    the drag-and-drop operation.</p>

   </li>

   <li>

    <p>Determine the <dfn id="list-of-dragged-nodes">list of dragged nodes</dfn>, as follows:</p>

    <p>If it is a selection that is being dragged, then the <a href="editing.html#list-of-dragged-nodes">list of dragged nodes</a>
    contains, in <a href="infrastructure.html#tree-order">tree order</a>, every node that is partially or completely included in the
    selection (including all their ancestors).</p>

    <p>Otherwise, the <a href="editing.html#list-of-dragged-nodes">list of dragged nodes</a> contains only the <a href="editing.html#source-node">source node</a>,
    if any.</p>

   </li>

   <li>

    <p>If it is a selection that is being dragged, then add an item to the <a href="editing.html#drag-data-store-item-list">drag data store
    item list</a>, with its properties set as follows:</p>

    <dl><dt><a href="editing.html#the-drag-data-item-type-string">The drag data item type string</a>
     <dd>"<code>text/plain</code>"</dd>

     <dt><a href="editing.html#the-drag-data-item-kind">The drag data item kind</a>
     <dd><i>Plain Unicode string</i></dd>

     <dt>The actual data</dt>
     <dd>The text of the selection</dd>

    </dl><p>Otherwise, if any files are being dragged, then add one item per file to the <a href="editing.html#drag-data-store-item-list">drag data
    store item list</a>, with their properties set as follows:</p>

    <dl><dt><a href="editing.html#the-drag-data-item-type-string">The drag data item type string</a>
     <dd>The MIME type of the file, if known, or "<code>application/octet-stream</code>" otherwise.</dd>

     <dt><a href="editing.html#the-drag-data-item-kind">The drag data item kind</a>
     <dd><i><a href="infrastructure.html#file">File</a></i></dd>

     <dt>The actual data</dt>
     <dd>The file's contents and name.</dd>

    </dl><p class="note">Dragging files can currently only happen from outside a <a href="browsers.html#browsing-context">browsing
    context</a>, for example from a file system manager application.</p>

    <p>If the drag initiated outside of the application, the user agent must add items to the
    <a href="editing.html#drag-data-store-item-list">drag data store item list</a> as appropriate for the data being dragged, honoring
    platform conventions where appropriate; however, if the platform conventions do not use <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> to label dragged data, the user agent must make a
    best-effort attempt to map the types to MIME types, and, in any case, all the <a data-anolis-xref="the
    drag data item type string" href="editing.html#the-drag-data-item-type-string">drag data item type strings</a> must be <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII
    lowercase</a>.</p>

    <p>User agents may also add one or more items representing the selection or dragged element(s)
    in other forms, e.g. as HTML.</p>

   </li>

   <!-- DND-v2: text/html as an export format -->

   <li>

    <p>Run the following substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">urls</var> be an empty list of <a data-anolis-xref="absolute URL" href="infrastructure.html#absolute-url">absolute
     URLs</a>.</li>

     <li>

      <p>For each <var data-anolis-xref="">node</var> in the <a href="editing.html#list-of-dragged-nodes">list of dragged nodes</a>:</p>

      <dl><dt>If the node is an <code><a href="text-level-semantics.html#the-a-element">a</a></code> element with an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute</dt>

       <dd>Add to <var data-anolis-xref="">urls</var> the result of <a data-anolis-xref="resolve a
       url" href="infrastructure.html#resolve-a-url">resolving</a> the element's <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> content
       attribute relative to the element.</dd>

       <dt>If the node is an <code><a href="embedded-content-0.html#the-img-element">img</a></code> element with a <code data-anolis-xref="attr-img-src"><a href="embedded-content-0.html#attr-img-src">src</a></code>
       attribute</dt>

       <dd>Add to <var data-anolis-xref="">urls</var> the result of <a data-anolis-xref="resolve a
       url" href="infrastructure.html#resolve-a-url">resolving</a> the element's <code data-anolis-xref="attr-img-src"><a href="embedded-content-0.html#attr-img-src">src</a></code> content attribute
       relative to the element.</dd>

       <!-- DND-v2: more -->

      </dl></li>

     <li><p>If <var data-anolis-xref="">urls</var> is still empty, abort these substeps.</li>

     <li><p>Let <var data-anolis-xref="">url string</var> be the result of concatenating the strings in <var data-anolis-xref="">urls</var>, in the order they were added, separated by a U+000D CARRIAGE RETURN U+000A
     LINE FEED character pair (CRLF).</li>

     <li><p>Add one item to the <a href="editing.html#drag-data-store-item-list">drag data store item list</a>, with its properties set as
     follows:</p>

      <dl><dt><a href="editing.html#the-drag-data-item-type-string">The drag data item type string</a>
       <dd><code>text/uri-list</code></dd>

       <dt><a href="editing.html#the-drag-data-item-kind">The drag data item kind</a>
       <dd><i>Plain Unicode string</i></dd>

       <dt>The actual data</dt>
       <dd><var data-anolis-xref="">url string</var></dd>

      </dl></li>

    </ol></li>

   <li>

    <p>Update the <a href="editing.html#drag-data-store-default-feedback">drag data store default feedback</a> as appropriate for the user agent
    (if the user is dragging the selection, then the selection would likely be the basis for this
    feedback; if the user is dragging an element, then that element's rendering would be used; if
    the drag began outside the user agent, then the platform conventions for determining the drag
    feedback should be used).</p>

   </li>

   <li>

    <p><a href="editing.html#fire-a-dnd-event">Fire a DND event</a> named <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> at the
    <a href="editing.html#source-node">source node</a>.</p>

    <p>If the event is canceled, then the drag-and-drop operation should not occur; abort these
    steps.</p> <!-- only a should because the UA can always allow the user to drag without the page
    knowing -->

    <p class="note">Since events with no event listeners registered are, almost by definition, never
    canceled, drag-and-drop is always available to the user if the author does not specifically
    prevent it.</p>

   </li>

   <li>

    <p><a href="editing.html#initiate-the-drag-and-drop-operation">Initiate the drag-and-drop operation</a> in a manner consistent with platform
    conventions, and as described below.</p>

    <p id="base-dnd-feedback">The drag-and-drop feedback must be generated from the first of the
    following sources that is available:</p>

    <ol><li>The <a href="editing.html#drag-data-store-bitmap">drag data store bitmap</a>, if any. In this case, the <a href="editing.html#drag-data-store-hot-spot-coordinate">drag data store
     hot spot coordinate</a> should be used as hints for where to put the cursor relative to the
     resulting image. The values are expressed as distances in CSS pixels from the left side and
     from the top side of the image respectively. <a href="references.html#refsCSS">[CSS]</a></li>

     <li>The <a href="editing.html#drag-data-store-default-feedback">drag data store default feedback</a>.</li>

    </ol></li>

  </ol><p>From the moment that the user agent is to <dfn id="initiate-the-drag-and-drop-operation">initiate the drag-and-drop operation</dfn>,
  until the end of the drag-and-drop operation, device input events (e.g. mouse and keyboard events)
  must be suppressed.</p>

  <p>During the drag operation, the element directly indicated by the user as the drop target is
  called the <dfn id="immediate-user-selection">immediate user selection</dfn>. (Only elements can be selected by the user; other
  nodes must not be made available as drop targets.) However, the <a href="editing.html#immediate-user-selection">immediate user
  selection</a> is not necessarily the <dfn id="current-target-element">current target element</dfn>, which is the element
  currently selected for the drop part of the drag-and-drop operation.</p>

  <p>The <a href="editing.html#immediate-user-selection">immediate user selection</a> changes as the user selects different elements
  (either by pointing at them with a pointing device, or by selecting them in some other way). The
  <a href="editing.html#current-target-element">current target element</a> changes when the <a href="editing.html#immediate-user-selection">immediate user selection</a>
  changes, based on the results of event listeners in the document, as described below.</p>

  <p>Both the <a href="editing.html#current-target-element">current target element</a> and the <a href="editing.html#immediate-user-selection">immediate user selection</a> can
  be null, which means no target element is selected. They can also both be elements in other
  (DOM-based) documents, or other (non-Web) programs altogether. (For example, a user could drag
  text to a word-processor.) The <a href="editing.html#current-target-element">current target element</a> is initially null.</p>

  <p>In addition, there is also a <dfn id="current-drag-operation">current drag operation</dfn>, which can take on the values
  "<code data-anolis-xref="">none</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">link</code>", and
  "<code data-anolis-xref="">move</code>". Initially, it has the value "<code data-anolis-xref="">none</code>". It is
  updated by the user agent as described in the steps below.</p>

  <p>User agents must, as soon as the drag operation is <a data-anolis-xref="initiate the drag-and-drop
  operation" href="editing.html#initiate-the-drag-and-drop-operation">initiated</a> and every 350ms (±200ms) thereafter for as long as the drag
  operation is ongoing, <a href="webappapis.html#queue-a-task">queue a task</a> to perform the following steps in sequence:</p>

  <ol><li>

    <p>If the user agent is still performing the previous iteration of the sequence (if any) when
    the next iteration becomes due, abort these steps for this iteration (effectively "skipping
    missed frames" of the drag-and-drop operation).</p>

   </li>

   <li>

    <p><a href="editing.html#fire-a-dnd-event">Fire a DND event</a> named <code data-anolis-xref="event-drag"><a href="editing.html#event-drag">drag</a></code> at the
    <a href="editing.html#source-node">source node</a>. If this event is canceled, the user agent must set the <a href="editing.html#current-drag-operation">current
    drag operation</a> to "<code data-anolis-xref="">none</code>" (no drag operation).</p>

   </li>

   <li>

    <p>If the <code data-anolis-xref="event-drag"><a href="editing.html#event-drag">drag</a></code> event was not canceled and the user has not ended
    the drag-and-drop operation, check the state of the drag-and-drop operation, as follows:</p>

    <ol><li>

      <p>If the user is indicating a different <a href="editing.html#immediate-user-selection">immediate user selection</a> than during the
      last iteration (or if this is the first iteration), and if this <a href="editing.html#immediate-user-selection">immediate user
      selection</a> is not the same as the <a href="editing.html#current-target-element">current target element</a>, then <a href="editing.html#fire-a-dnd-event">fire a
      DND event</a> named <code data-anolis-xref="event-dragexit"><a href="editing.html#event-dragexit">dragexit</a></code> at the <a href="editing.html#current-target-element">current
      target element</a>, and then update the <a href="editing.html#current-target-element">current target element</a> as follows:</p>

      <dl class="switch"><dt>If the new <a href="editing.html#immediate-user-selection">immediate user selection</a> is null</dt>

       <dd><p>Set the <a href="editing.html#current-target-element">current target element</a> to null also.</dd>

       <dt>If the new <a href="editing.html#immediate-user-selection">immediate user selection</a> is in a non-DOM document or
       application</dt>

       <dd><p>Set the <a href="editing.html#current-target-element">current target element</a> to the <a href="editing.html#immediate-user-selection">immediate user
       selection</a>.</dd>

       <dt>Otherwise</dt>

       <dd>

        <p><a href="editing.html#fire-a-dnd-event">Fire a DND event</a> named <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> at the
        <a href="editing.html#immediate-user-selection">immediate user selection</a>.</p>

        <p>If the event is canceled, then set the <a href="editing.html#current-target-element">current target element</a> to the
        <a href="editing.html#immediate-user-selection">immediate user selection</a>.</p>

        <p>Otherwise, run the appropriate step from the following list:</p>

        <dl class="switch"><dt>If the <a href="editing.html#immediate-user-selection">immediate user selection</a> is a text field (e.g.
         <code><a href="forms.html#the-textarea-element">textarea</a></code>, or an <code><a href="forms.html#the-input-element">input</a></code> element whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is in the <a data-anolis-xref="attr-input-type-text" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Text</a> state) or an <a href="editing.html#editing-host">editing host</a> or
         <a href="editing.html#editable">editable</a> element, and the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> has an item
         with <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a> "<code>text/plain</code>" and <a href="editing.html#the-drag-data-item-kind">the
         drag data item kind</a> <i>Plain Unicode string</i></dt>

         <dd><p>Set the <a href="editing.html#current-target-element">current target element</a> to the <a href="editing.html#immediate-user-selection">immediate user
         selection</a> anyway.</dd>


         <dt>If the <a href="editing.html#immediate-user-selection">immediate user selection</a> is an element with a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute that <a data-anolis-xref="concept-dropzone-match" href="editing.html#concept-dropzone-match">matches</a> the <a href="editing.html#drag-data-store">drag data store</a></dt>

         <dd><p>Set the <a href="editing.html#current-target-element">current target element</a> to the <a href="editing.html#immediate-user-selection">immediate user
         selection</a> anyway.</dd>


         <dt>If the <a href="editing.html#immediate-user-selection">immediate user selection</a> is an element that itself has an ancestor
         element with a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute that <a data-anolis-xref="concept-dropzone-match" href="editing.html#concept-dropzone-match">matches</a> the <a href="editing.html#drag-data-store">drag data store</a></dt>

         <dd>

          <p>Let <var data-anolis-xref="">new target</var> be the nearest (deepest) such ancestor element.</p>

          <p>If the <a href="editing.html#immediate-user-selection">immediate user selection</a> is <var data-anolis-xref="">new target</var>, then
          leave the <a href="editing.html#current-target-element">current target element</a> unchanged.</p>

          <p>Otherwise, <a href="editing.html#fire-a-dnd-event">fire a DND event</a> named <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> at <var data-anolis-xref="">new target</var>. Then, set the
          <a href="editing.html#current-target-element">current target element</a> to <var data-anolis-xref="">new target</var>, regardless of
          whether that event was canceled or not.</p>

         </dd>


         <dt>If the <a href="editing.html#immediate-user-selection">immediate user selection</a> is <a href="dom.html#the-body-element-0">the body element</a></dt>

         <dd><p>Leave the <a href="editing.html#current-target-element">current target element</a> unchanged.</dd>


         <dt>Otherwise</dt>

         <dd>

          <p><a href="editing.html#fire-a-dnd-event">Fire a DND event</a> named <code data-anolis-xref="event-dragenter"><a href="editing.html#event-dragenter">dragenter</a></code> at
          <a href="dom.html#the-body-element-0">the body element</a>, if there is one, or at the <code><a href="dom.html#document">Document</a></code> object, if
          not. Then, set the <a href="editing.html#current-target-element">current target element</a> to <a href="dom.html#the-body-element-0">the body element</a>,
          regardless of whether that event was canceled or not.</p>

         </dd>

        </dl></dd>

      </dl></li>

     <li>

      <p>If the previous step caused the <a href="editing.html#current-target-element">current target element</a> to change, and if the
      previous target element was not null or a part of a non-DOM document, then <a href="editing.html#fire-a-dnd-event">fire a DND
      event</a> named <code data-anolis-xref="event-dragleave"><a href="editing.html#event-dragleave">dragleave</a></code> at the previous target
      element.</p>

     </li>

     <li>

      <p>If the <a href="editing.html#current-target-element">current target element</a> is a DOM element, then <a href="editing.html#fire-a-dnd-event">fire a DND
      event</a> named <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code> at this <a href="editing.html#current-target-element">current target
      element</a>.</p>

      <p>If the <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code> event is not canceled, run the
      appropriate step from the following list:</p>

      <dl class="switch"><dt>If the <a href="editing.html#current-target-element">current target element</a> is a text field (e.g. <code><a href="forms.html#the-textarea-element">textarea</a></code>,
       or an <code><a href="forms.html#the-input-element">input</a></code> element whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is
       in the <a data-anolis-xref="attr-input-type-text" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Text</a> state) or an <a href="editing.html#editing-host">editing host</a>
       or <a href="editing.html#editable">editable</a> element, and the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> has an item
       with <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a> "<code>text/plain</code>" and <a href="editing.html#the-drag-data-item-kind">the drag
       data item kind</a> <i>Plain Unicode string</i></dt>

       <dd><p>Set the <a href="editing.html#current-drag-operation">current drag operation</a> to either "<code data-anolis-xref="">copy</code>" or
       "<code data-anolis-xref="">move</code>", as appropriate given the platform conventions.</dd>


       <dt>If the <a href="editing.html#current-target-element">current target element</a> is an element with a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute that <a data-anolis-xref="concept-dropzone-match" href="editing.html#concept-dropzone-match">matches</a> the <a href="editing.html#drag-data-store">drag data store</a> and <a data-anolis-xref="concept-dropzone-operation" href="editing.html#concept-dropzone-operation">specifies an operation</a></dt>

       <dd><p>Set the <a href="editing.html#current-drag-operation">current drag operation</a> to the operation <a data-anolis-xref="concept-dropzone-operation" href="editing.html#concept-dropzone-operation">specified</a> by the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute of the <a href="editing.html#current-target-element">current target
       element</a>.</p>


       <dt>If the <a href="editing.html#current-target-element">current target element</a> is an element with a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute that <a data-anolis-xref="concept-dropzone-match" href="editing.html#concept-dropzone-match">matches</a> the <a href="editing.html#drag-data-store">drag data store</a> and does not
       <a data-anolis-xref="concept-dropzone-operation" href="editing.html#concept-dropzone-operation">specify an operation</a></dt>

       <dd><p>Set the <a href="editing.html#current-drag-operation">current drag operation</a> to "<code data-anolis-xref="">copy</code>".</p>


       <dt>Otherwise</dt>

       <dd><p>Reset the <a href="editing.html#current-drag-operation">current drag operation</a> to "<code data-anolis-xref="">none</code>".</dd>

      </dl><p>Otherwise (if the <code data-anolis-xref="event-dragover"><a href="editing.html#event-dragover">dragover</a></code> event <em>is</em> canceled),
      set the <a href="editing.html#current-drag-operation">current drag operation</a> based on the values of the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> and <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attributes of the <code><a href="editing.html#dragevent">DragEvent</a></code>
      object's <code data-anolis-xref="dom-DragEvent-dataTransfer"><a href="editing.html#dom-dragevent-datatransfer">dataTransfer</a></code> object as they stood
      after the event <a data-anolis-xref="concept-event-dispatch" href="infrastructure.html#concept-event-dispatch">dispatch</a> finished, as per the
      following table:</p>

      <table><thead><tr><th><code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code></th>
         <th><code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code></th>
         <th>Drag operation</th>
        <tbody><tr><td>"<code data-anolis-xref="">uninitialized</code>", "<code data-anolis-xref="">copy</code>", "<code data-anolis-xref="">copyLink</code>", "<code data-anolis-xref="">copyMove</code>", or "<code data-anolis-xref="">all</code>"</td>
        <td>"<code data-anolis-xref="">copy</code>"</td>
        <td>"<code data-anolis-xref="">copy</code>"</td>
       <tr><td>"<code data-anolis-xref="">uninitialized</code>", "<code data-anolis-xref="">link</code>", "<code data-anolis-xref="">copyLink</code>", "<code data-anolis-xref="">linkMove</code>", or "<code data-anolis-xref="">all</code>"</td>
        <td>"<code data-anolis-xref="">link</code>"</td>
        <td>"<code data-anolis-xref="">link</code>"</td>
       <tr><td>"<code data-anolis-xref="">uninitialized</code>", "<code data-anolis-xref="">move</code>", "<code data-anolis-xref="">copyMove</code>", "<code data-anolis-xref="">linkMove</code>", or "<code data-anolis-xref="">all</code>"</td>
        <td>"<code data-anolis-xref="">move</code>"</td>
        <td>"<code data-anolis-xref="">move</code>"</td>
       <tr><td colspan="2">Any other case</td>
        <td>"<code data-anolis-xref="">none</code>"</td>
       </table></li>

     <li>

      <p>Otherwise, if the <a href="editing.html#current-target-element">current target element</a> is not a DOM element, use
      platform-specific mechanisms to determine what drag operation is being performed (none, copy,
      link, or move), and set the <i><a href="editing.html#current-drag-operation">current drag operation</a></i> accordingly.</p>

     </li>

     <li>

      <p>Update the drag feedback (e.g. the mouse cursor) to match the <a href="editing.html#current-drag-operation">current drag
      operation</a>, as follows:</p>

      <table><thead><tr><th>Drag operation</th>
         <th>Feedback</th>
        <tbody><tr><td>"<code data-anolis-xref="">copy</code>"</td>
        <td>Data will be copied if dropped here.</td>
       <tr><td>"<code data-anolis-xref="">link</code>"</td>
        <td>Data will be linked if dropped here.</td>
       <tr><td>"<code data-anolis-xref="">move</code>"</td>
        <td>Data will be moved if dropped here.</td>
       <tr><td>"<code data-anolis-xref="">none</code>"</td>
        <td>No operation allowed, dropping here will cancel the drag-and-drop operation.</td>
       </table></li>

    </ol></li>

   <li>

    <p>Otherwise, if the user ended the drag-and-drop operation (e.g. by releasing the mouse button
    in a mouse-driven drag-and-drop interface), or if the <code data-anolis-xref="event-drag"><a href="editing.html#event-drag">drag</a></code> event
    was canceled, then this will be the last iteration. Run the following steps, then stop the
    drag-and-drop operation:</p>

    <ol><li>

      <p>If the <a href="editing.html#current-drag-operation">current drag operation</a> is "<code data-anolis-xref="">none</code>" (no drag
      operation), or, if the user ended the drag-and-drop operation by canceling it (e.g. by hitting
      the <kbd>Escape</kbd> key), or if the <a href="editing.html#current-target-element">current target element</a> is null, then the
      drag operation failed. Run these substeps:</p>

      <ol><li><p>Let <var data-anolis-xref="">dropped</var> be false.</li>

       <li><p>If the <a href="editing.html#current-target-element">current target element</a> is a DOM element, <a href="editing.html#fire-a-dnd-event">fire a DND
       event</a> named <code data-anolis-xref="event-dragleave"><a href="editing.html#event-dragleave">dragleave</a></code> at it; otherwise, if it is
       not null, use platform-specific conventions for drag cancellation.</li>

       <li><p>Set the <a href="editing.html#current-drag-operation">current drag operation</a> to "<code data-anolis-xref="">none</code>".</li>

      </ol><p>Otherwise, the drag operation might be a success; run these substeps:</p>

      <ol><li><p>Let <var data-anolis-xref="">dropped</var> be true.</li>

       <li><p>If the <a href="editing.html#current-target-element">current target element</a> is a DOM element, <a href="editing.html#fire-a-dnd-event">fire a DND
       event</a> named <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> at it; otherwise, use
       platform-specific conventions for indicating a drop.</li>

       <li>

        <p>If the event is canceled, set the <a href="editing.html#current-drag-operation">current drag operation</a> to the value of the
        <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> attribute of the
        <code><a href="editing.html#dragevent">DragEvent</a></code> object's <code data-anolis-xref="dom-DragEvent-dataTransfer"><a href="editing.html#dom-dragevent-datatransfer">dataTransfer</a></code>
        object as it stood after the event <a data-anolis-xref="concept-event-dispatch" href="infrastructure.html#concept-event-dispatch">dispatch</a>
        finished.</p>

        <p>Otherwise, the event is not canceled; perform the event's default action, which depends
        on the exact target as follows:</p>

        <dl class="switch"><dt>If the <a href="editing.html#current-target-element">current target element</a> is a text field (e.g. <code><a href="forms.html#the-textarea-element">textarea</a></code>,
         or an <code><a href="forms.html#the-input-element">input</a></code> element whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute
         is in the <a data-anolis-xref="attr-input-type-text" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Text</a> state) or an <a href="editing.html#editing-host">editing
         host</a> or <a href="editing.html#editable">editable</a> element, and the <a href="editing.html#drag-data-store-item-list">drag data store item
         list</a> has an item with <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a>
         "<code>text/plain</code>" and <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> <i>Plain Unicode
         string</i></dt>

         <dd><p>Insert the actual data of the first item in the <a href="editing.html#drag-data-store-item-list">drag data store item
         list</a> to have <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">a drag data item type
         string</a> of "<code>text/plain</code>" and <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">a drag
         data item kind</a> that is <i>Plain Unicode string</i> into the text field or
         <a href="editing.html#editing-host">editing host</a> or <a href="editing.html#editable">editable</a> element in a manner consistent with
         platform-specific conventions (e.g. inserting it at the current mouse cursor position, or
         inserting it at the end of the field).</dd>

         <dt>Otherwise</dt>

         <dd><p>Reset the <a href="editing.html#current-drag-operation">current drag operation</a> to "<code data-anolis-xref="">none</code>".</dd>

        </dl></li>

      </ol></li>

     <li>

      <p><a href="editing.html#fire-a-dnd-event">Fire a DND event</a> named <code data-anolis-xref="event-dragend"><a href="editing.html#event-dragend">dragend</a></code> at the
      <a href="editing.html#source-node">source node</a>.</p>

     </li>

     <li>

      <p>Run the appropriate steps from the following list as the default action of the <code data-anolis-xref="event-dragend"><a href="editing.html#event-dragend">dragend</a></code> event:</p>

      <dl class="switch"><dt>If <var data-anolis-xref="">dropped</var> is true, the <a href="editing.html#current-target-element">current target element</a> is a
       <i>text field</i> (see below), the <a href="editing.html#current-drag-operation">current drag operation</a> is "<code data-anolis-xref="">move</code>", and the source of the drag-and-drop operation is a selection in the
       DOM that is entirely contained within an <a href="editing.html#editing-host">editing host</a></dt>

       <dd><p><a href="editing.html#delete-the-selection">Delete the selection</a>.</dd>

       <dt>If <var data-anolis-xref="">dropped</var> is true, the <a href="editing.html#current-target-element">current target element</a> is a
       <i>text field</i> (see below), the <a href="editing.html#current-drag-operation">current drag operation</a> is "<code data-anolis-xref="">move</code>", and the source of the drag-and-drop operation is a selection in a text
       field</dt>

       <dd><p>The user agent should delete the dragged selection from the relevant text
       field.</dd>

       <dt>If <var data-anolis-xref="">dropped</var> is false or if the <a href="editing.html#current-drag-operation">current drag operation</a> is
       "<code data-anolis-xref="">none</code>"</dt>

       <dd><p>The drag was canceled. If the platform conventions dictate that this be represented to
       the user (e.g. by animating the dragged selection going back to the source of the
       drag-and-drop operation), then do so.</dd>

       <dt>Otherwise</dt>

       <dd><p>The event has no default action.</dd>

      </dl><p>For the purposes of this step, a <i>text field</i> is a <code><a href="forms.html#the-textarea-element">textarea</a></code> element or an
      <code><a href="forms.html#the-input-element">input</a></code> element whose <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is in one
      of the
      <a data-anolis-xref="attr-input-type-text" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Text</a>,
      <a data-anolis-xref="attr-input-type-search" href="forms.html#text-(type=text)-state-and-search-state-(type=search)">Search</a>,
      <a data-anolis-xref="attr-input-type-tel" href="forms.html#telephone-state-(type=tel)">Tel</a>,
      <a data-anolis-xref="attr-input-type-url" href="forms.html#url-state-(type=url)">URL</a>,
      <a data-anolis-xref="attr-input-type-email" href="forms.html#e-mail-state-(type=email)">E-mail</a>,
      <a data-anolis-xref="attr-input-type-password" href="forms.html#password-state-(type=password)">Password</a>, or
      <a data-anolis-xref="attr-input-type-number" href="forms.html#number-state-(type=number)">Number</a>
      states.</p>


     </li>

    </ol></li>

  </ol><p class="note">User agents are encouraged to consider how to react to drags near the edge of
  scrollable regions. For example, if a user drags a link to the bottom of the viewport on a long
  page, it might make sense to scroll the page so that the user can drop the link lower on the
  page.</p>

  <p class="note">This model is independent of which <code><a href="dom.html#document">Document</a></code> object the nodes involved
  are from; the events are fired as described above and the rest of the processing model runs as
  described above, irrespective of how many documents are involved in the operation.</p>

  </div>


  <h4 id="dndevents"><span class="secno">7.7.6 </span>Events summary</h4>

  <p><i>This section is non-normative.</i></p>
  <p>The following events are involved in the drag-and-drop
  model.</p>

  <table><thead><tr><th> Event Name </th>
     <th> Target </th>
     <!-- <th> Bubbles? </th> -->
     <th> Cancelable? </th>
     <th> <a href="editing.html#drag-data-store-mode">Drag data store mode</a> </th>
     <!-- <th> <code data-x="dom-DataTransfer-effectAllowed">effectAllowed</code> </th> -->
     <th> <code data-anolis-xref="dom-DataTransfer-dropEffect"><a href="editing.html#dom-datatransfer-dropeffect">dropEffect</a></code> </th>
     <th> Default Action </th>
    <tbody><tr><td><dfn data-anolis-xref="event-dragstart" id="event-dragstart"><code>dragstart</code></dfn></td>
     <td><a href="editing.html#source-node">Source node</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>✓ Cancelable</td>
     <td><a data-anolis-xref="concept-dnd-rw" href="editing.html#concept-dnd-rw">Read/write mode</a>
     <!-- <td>"<code data-x="">uninitialized</code>"</td> -->
     <td>"<code data-anolis-xref="">none</code>"</td>
     <td>Initiate the drag-and-drop operation</td>
    <tr><td><dfn data-anolis-xref="event-drag" id="event-drag"><code>drag</code></dfn></td>
     <td><a href="editing.html#source-node">Source node</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>✓ Cancelable</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td>"<code data-anolis-xref="">none</code>"</td>
     <td>Continue the drag-and-drop operation</td>
    <tr><td><dfn data-anolis-xref="event-dragenter" id="event-dragenter"><code>dragenter</code></dfn></td>
     <td><a href="editing.html#immediate-user-selection">Immediate user selection</a> or <a href="dom.html#the-body-element-0">the body element</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>✓ Cancelable</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td><a href="editing.html#dropEffect-initialization">Based on <code>effectAllowed</code> value</a></td>
     <td>Reject <a href="editing.html#immediate-user-selection">immediate user selection</a> as potential <a data-anolis-xref="current target element" href="editing.html#current-target-element">target element</a></td>
    <tr><td><dfn data-anolis-xref="event-dragexit" id="event-dragexit"><code>dragexit</code></dfn></td>
     <td><a data-anolis-xref="current target element" href="editing.html#current-target-element">Previous target element</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>—</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td>"<code data-anolis-xref="">none</code>"</td>
     <td>None</td>
    <tr><td><dfn data-anolis-xref="event-dragleave" id="event-dragleave"><code>dragleave</code></dfn></td>
     <td><a data-anolis-xref="current target element" href="editing.html#current-target-element">Previous target element</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>—</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td>"<code data-anolis-xref="">none</code>"</td>
     <td>None</td>
    <tr><td><dfn data-anolis-xref="event-dragover" id="event-dragover"><code>dragover</code></dfn></td>
     <td><a href="editing.html#current-target-element">Current target element</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>✓ Cancelable</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td><a href="editing.html#dropEffect-initialization">Based on <code>effectAllowed</code> value</a></td>
     <td>Reset the <a href="editing.html#current-drag-operation">current drag operation</a> to "none"</td>
    <tr><td><dfn data-anolis-xref="event-drop" id="event-drop"><code>drop</code></dfn></td>
     <td><a href="editing.html#current-target-element">Current target element</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>✓ Cancelable</td>
     <td><a data-anolis-xref="concept-dnd-ro" href="editing.html#concept-dnd-ro">Read-only mode</a>
     <!-- <td>Same as last event</td> -->
     <td><a href="editing.html#current-drag-operation">Current drag operation</a></td>
     <td>Varies</td>
    <tr><td><dfn data-anolis-xref="event-dragend" id="event-dragend"><code>dragend</code></dfn></td>
     <td><a href="editing.html#source-node">Source node</a></td>
     <!-- <td>&#x2713; Bubbles</td> -->
     <td>—</td>
     <td><a data-anolis-xref="concept-dnd-p" href="editing.html#concept-dnd-p">Protected mode</a>
     <!-- <td>Same as last event</td> -->
     <td><a href="editing.html#current-drag-operation">Current drag operation</a></td>
     <td>Varies</td>
    </table><p>Not shown in the above table: all these events bubble, and the <code data-anolis-xref="dom-DataTransfer-effectAllowed"><a href="editing.html#dom-datatransfer-effectallowed">effectAllowed</a></code> attribute always has the value it had
  after the <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event, defaulting to "<code data-anolis-xref="">uninitialized</code>" in the <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event.</p>



  <h4 id="the-draggable-attribute"><span class="secno">7.7.7 </span>The <dfn data-anolis-xref="attr-draggable" id="attr-draggable"><code>draggable</code></dfn> attribute</h4>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code>
  content attribute set. The <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> attribute is an
  <a href="infrastructure.html#enumerated-attribute">enumerated attribute</a>. It has three states. The first state is <i>true</i> and it has
  the keyword <code data-anolis-xref="">true</code>. The second state is <i>false</i> and it has the keyword
  <code data-anolis-xref="">false</code>. The third state is <i>auto</i>; it has no keywords but it is the
  <i>missing value default</i>.</p>

  <p>The <i>true</i> state means the element is draggable; the <i>false</i> state means that it is
  not. The <i>auto</i> state uses the default behavior of the user agent.</p>

  <p>An element with a <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> attribute should also have a
  <code data-anolis-xref="attr-title"><a href="dom.html#attr-title">title</a></code> attribute that names the element for the purpose of
  non-visual interactions. <!-- "should", not "must", only because this is a relatively new
  attribute and its design implications are not entirely obvious yet. For example, what happens if
  you use an element with text as a drag source? Is that sufficiently clear for ATs? Indeed,
  shouldn't the element generally be distinguishable anyway for it to be useful to drag? See also
  the dropzone attribute. --></p>

  <dl class="domintro"><dt><var data-anolis-xref="">element</var> . <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if the element is draggable; otherwise, returns false.</p>

    <p>Can be set, to override the default and set the <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code>
    content attribute.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-draggable" id="dom-draggable"><code>draggable</code></dfn> IDL attribute, whose value depends
  on the content attribute's in the way described below, controls whether or not the element is
  draggable. Generally, only text selections are draggable, but elements whose <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute is true become draggable as well.</p>

  <p>If an element's <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> content attribute has the state
  <i>true</i>, the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute must return true.</p>

  <p>Otherwise, if the element's <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> content attribute has
  the state <i>false</i>, the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute must return
  false.</p>

  <p>Otherwise, the element's <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> content attribute has
  the state <i>auto</i>. If the element is an <code><a href="embedded-content-0.html#the-img-element">img</a></code> element, an <code><a href="embedded-content-0.html#the-object-element">object</a></code>
  element that <a href="dom.html#represents">represents</a> an image, or an <code><a href="text-level-semantics.html#the-a-element">a</a></code> element with an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> content attribute, the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute must return true; otherwise, the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute must return false.</p>

  <p>If the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL attribute is set to the value false,
  the <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> content attribute must be set to the literal
  value <code data-anolis-xref="">false</code>. If the <code data-anolis-xref="dom-draggable"><a href="editing.html#dom-draggable">draggable</a></code> IDL
  attribute is set to the value true, the <code data-anolis-xref="attr-draggable"><a href="editing.html#the-draggable-attribute">draggable</a></code> content
  attribute must be set to the literal value <code data-anolis-xref="">true</code>.</p>

  </div>


  <h4 id="the-dropzone-attribute"><span class="secno">7.7.8 </span>The <dfn data-anolis-xref="attr-dropzone" id="attr-dropzone"><code>dropzone</code></dfn> attribute</h4>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> content
  attribute set. When specified, its value must be an <a href="infrastructure.html#unordered-set-of-unique-space-separated-tokens">unordered set of unique space-separated
  tokens</a> that are <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a>. The allowed values are the
  following:</p>

  <dl><dt><dfn data-anolis-xref="attr-dropzone-copy" id="attr-dropzone-copy"><code>copy</code></dfn></dt>

   <dd><p>Indicates that dropping an accepted item on the element will result in a copy of the
   dragged data.</p>


   <dt><dfn data-anolis-xref="attr-dropzone-move" id="attr-dropzone-move"><code>move</code></dfn></dt>

   <dd><p>Indicates that dropping an accepted item on the element will result in the dragged data
   being moved to the new location.</p>


   <dt><dfn data-anolis-xref="attr-dropzone-link" id="attr-dropzone-link"><code>link</code></dfn></dt>

   <dd><p>Indicates that dropping an accepted item on the element will result in a link to the
   original data.</p>


   <dt>Any keyword with eight characters or more, beginning with the an <a href="infrastructure.html#ascii-case-insensitive">ASCII
   case-insensitive</a> match for the string "<code data-anolis-xref="">string:</code>"</dt>

   <dd><p>Indicates that items with <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> <i>Plain Unicode string</i>
   and <a href="editing.html#the-drag-data-item-type-string">the drag data item type string</a> set to a value that matches the remainder of the
   keyword are accepted.</dd>

<!--DND-v3:
   <dt>Any keyword with six characters or more, beginning with an <span>ASCII
   case-insensitive</span> match for the string "<code data-x="">blob:</code>"</dt>

   <dd><p>Indicates that items with <span>the drag data item kind</span> <i>Blob</i>, <i>File</i>,
   or <i>Plain Unicode string</i> and <span>the drag data item type string</span> set to a value
   that matches the remainder of the keyword are accepted.</p></dd>
-->

   <dt>Any keyword with six characters or more, beginning with an <a href="infrastructure.html#ascii-case-insensitive">ASCII
   case-insensitive</a> match for the string "<code data-anolis-xref="">file:</code>"</dt>

   <dd><p>Indicates that items with <a href="editing.html#the-drag-data-item-kind">the drag data item kind</a> <i><a href="infrastructure.html#file">File</a></i> and <a href="editing.html#the-drag-data-item-type-string">the
   drag data item type string</a> set to a value that matches the remainder of the keyword are
   accepted.</dd>

<!--DND-v4:
   <dt>Any keyword with eight characters or more, beginning with an <span>ASCII
   case-insensitive</span> match for the string "<code data-x="">object:</code>"</dt>

   <dd><p>Indicates that items with <span>the drag data item type string</span> set to a value that
   matches the remainder of the keyword are accepted.</p></dd>
-->

  </dl><p>The <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> content attribute's values must not have more
  than one of the three feedback values (<code data-anolis-xref="attr-dropzone-copy"><a href="editing.html#attr-dropzone-copy">copy</a></code>, <code data-anolis-xref="attr-dropzone-move"><a href="editing.html#attr-dropzone-move">move</a></code>, and <code data-anolis-xref="attr-dropzone-link"><a href="editing.html#attr-dropzone-link">link</a></code>)
  specified. If none are specified, the <code data-anolis-xref="attr-dropzone-copy"><a href="editing.html#attr-dropzone-copy">copy</a></code> value is
  implied.</p>

  <p>An element with a <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute should also have a
  <code data-anolis-xref="attr-title"><a href="dom.html#attr-title">title</a></code> attribute that names the element for the purpose of
  non-visual interactions. <!-- "should", not "must", only because this is a relatively new
  attribute and its design implications are not entirely obvious yet. For example, what happens if
  you use an element with text as a drop zone? Is that sufficiently clear for ATs? See also the
  draggable attribute. --></p>

  <div class="impl">

  <p>A <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute <dfn data-anolis-xref="concept-dropzone-match" id="concept-dropzone-match">matches a drag data store</dfn> if the <a href="editing.html#dropzone-processing-steps"><code data-anolis-xref="attr-dropzone">dropzone</code> processing steps</a> result in a match.</p>

  <p>A <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute <dfn data-anolis-xref="concept-dropzone-operation" id="concept-dropzone-operation">specifies an operation</dfn> if the <a href="editing.html#dropzone-processing-steps"><code data-anolis-xref="attr-dropzone">dropzone</code> processing steps</a> result in a specified operation. The
  specified operation is as given by those steps.</p>

  <p>The <dfn id="dropzone-processing-steps"><code data-anolis-xref="attr-dropzone">dropzone</code> processing steps</dfn> are as follows.
  They either result in a match or not, and separate from this result either in a specified
  operation or not, as defined below.</p>

  <ol><li><p>Let <var data-anolis-xref="">value</var> be the value of the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute.</li>

   <li><p>Let <var data-anolis-xref="">keywords</var> be the result of <a data-anolis-xref="split a string on
   spaces" href="infrastructure.html#split-a-string-on-spaces">splitting <var data-anolis-xref="">value</var> on spaces</a>.</li>

   <li><p>Let <var data-anolis-xref="">matched</var> be false.</li>

   <li><p>Let <var data-anolis-xref="">operation</var> be unspecified.</li>

   <li>

    <p>For each value in <var data-anolis-xref="">keywords</var>, if any, in the order that they were found in
    <var data-anolis-xref="">value</var>, run the following steps.</p>

    <ol><li><p>Let <var data-anolis-xref="">keyword</var> be the keyword.</li>

     <li>

      <p>If <var data-anolis-xref="">keyword</var> is one of "<code data-anolis-xref="attr-dropzone-copy"><a href="editing.html#attr-dropzone-copy">copy</a></code>",
      "<code data-anolis-xref="attr-dropzone-move"><a href="editing.html#attr-dropzone-move">move</a></code>", or "<code data-anolis-xref="attr-dropzone-link"><a href="editing.html#attr-dropzone-link">link</a></code>", then: run the following substeps:</p>

      <ol><li><p>If <var data-anolis-xref="">operation</var> is still unspecified, then let <var data-anolis-xref="">operation</var> be the string given by <var data-anolis-xref="">keyword</var>.</li>

       <li><p>Skip to the step labeled <i>end of keyword</i> below.</li>

      </ol></li>

     <li><p>If <var data-anolis-xref="">keyword</var> does not contain a ":" (U+003A) character, or if the
     first such character in <var data-anolis-xref="">keyword</var> is either the first character or the last
     character in the string, then skip to the step labeled <i>end of keyword</i> below.</li>

     <li><p>Let <var data-anolis-xref="">kind code</var> be the substring of <var data-anolis-xref="">keyword</var> from
     the first character in the string to the last character in the string that is before the first
     ":" (U+003A) character in the string, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</p>

     <li>

      <p>Jump to the appropriate step from the list below, based on the value of <var data-anolis-xref="">kind
      code</var>:</p>

      <dl class="switch"><dt>If <var data-anolis-xref="">kind code</var> is the string "<code data-anolis-xref="">string</code>"</dt>
       <dd>

        <p>Let <var data-anolis-xref="">kind<!--DND-v3:/DND-v4: s--></var> be <i>Plain Unicode string</i>.</p>

       </dd>

<!--DND-v3:
       <dt>If <var data-x="">kind code</var> is the string "<code data-x="">blob</code>"</dt>
       <dd>

        <p>Let <var data-x="">kinds</var> be <i>Plain Unicode string</i>, <i>Blob</i>, and
        <i>File</i>.</p>

       </dd>
-->

       <dt>If <var data-anolis-xref="">kind code</var> is the string "<code data-anolis-xref="">file</code>"</dt>
       <dd>

        <p>Let <var data-anolis-xref="">kind<!--DND-v3:/DND-v4: s--></var> be <i><a href="infrastructure.html#file">File</a></i>.</p>

       </dd>

<!--DND-v4:
       <dt>If <var data-x="">kind code</var> is the string "<code data-x="">object</code>"</dt>
       <dd>

        <p>Let <var data-x="">kinds</var> be <i>Plain Unicode string</i>, <i>Blob</i>, <i>File</i>,
        and <i>Object</i>.</p>

       </dd>
-->

       <dt>Otherwise</dt>
       <dd>

        <p>Skip to the step labeled <i>end of keyword</i> below.</p>

       </dd>

      </dl></li>

     <li><p>Let <var data-anolis-xref="">type</var> be the substring of <var data-anolis-xref="">keyword</var> from the
     first character after the first ":" (U+003A) character in the string, to the last character
     in the string, <a href="infrastructure.html#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</li>

     <li><p>If there exist any items in the <a href="editing.html#drag-data-store-item-list">drag data store item list</a> whose <a data-anolis-xref="the drag data item kind" href="editing.html#the-drag-data-item-kind">drag data item kind</a> is <!--DND-v3:/DND-v4: one of--> the
     kind<!--DND-v3:/DND-v4: s--> given in <var data-anolis-xref="">kind<!--DND-v3:/DND-v4: s--></var> and
     whose <a data-anolis-xref="the drag data item type string" href="editing.html#the-drag-data-item-type-string">drag data item type string</a> is <var data-anolis-xref="">type</var>, then let <var data-anolis-xref="">matched</var> be true.</li>

     <li><p><i>End of keyword</i>: Go on to the next keyword, if any, or the next step in the
     overall algorithm, if there are no more.</li>

    </ol></li>

   <li>

    <p>The algorithm results in a match if <var data-anolis-xref="">matched</var> is true, and does not
    otherwise.</p>

    <p>The algorithm results in a specified operation if <var data-anolis-xref="">operation</var> is not
    unspecified. The specified operation, if one is specified, is the one given by <var data-anolis-xref="">operation</var>.</p>

   </li>

  </ol><p>The <dfn data-anolis-xref="dom-dropzone" id="dom-dropzone"><code>dropzone</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the content attribute of the same name.</p>

  </div>

  <div class="example">

   <p>In this example, a <code><a href="grouping-content.html#the-div-element">div</a></code> element is made into a drop target for image files using
   the <code data-anolis-xref="attr-dropzone"><a href="editing.html#the-dropzone-attribute">dropzone</a></code> attribute. Images dropped into the target are
   then displayed.</p>

   <pre>&lt;div dropzone="copy file:image/png file:image/gif file:image/jpeg" ondrop="receive(event, this)"&gt;
 &lt;p&gt;Drop an image here to have it displayed.&lt;/p&gt;
&lt;/div&gt;
&lt;script&gt;
 function receive(event, element) {
   var data = event.dataTransfer.items;
   for (var i = 0; i &lt; data.length; i += 1) {
     if ((data[i].kind == 'file') &amp;&amp; (data[i].type.match('^image/'))) {
       var img = new Image();
       img.src = window.createObjectURL(data[i].getAsFile());
       element.appendChild(img);
     }
   }
 }
&lt;/script&gt;</pre>

  </div>


<!--
  <h4>Copy and paste</h4>

  <p>Copy-and-paste is a form of drag-and-drop: the "copy" part is equivalent to dragging content to
  another application (the "clipboard"), and the "paste" part is equivalent to dragging content
  <em>from</em> another application.</p>

  <p>Select-and-paste (a model used by mouse operations in the X Window System) is equivalent to a
  drag-and-drop operation where the source is the selection.</p>


  <div class="impl">

  <h5>Copy to clipboard</h5>

  <p>When the user invokes a copy operation, the user agent must act as if the user had invoked a
  drag on the current selection. If the drag-and-drop operation initiates, then the user agent must
  act as if the user had indicated (as the <span>immediate user selection</span>) a hypothetical
  application representing the clipboard. Then, the user agent must act as if the user had ended the
  drag-and-drop operation without canceling it. If the drag-and-drop operation didn't get canceled,
  the user agent should then follow the relevant platform-specific conventions for copy operations
  (e.g. updating the clipboard).</p>

  <p>The events involved in this process are the <code data-x="event-dragstart">dragstart</code>,
  <code data-x="event-drag">drag</code>, and <code data-x="event-dragend">dragend</code> events.</p>


  <h5>Cut to clipboard</h5>

  <p>When the user invokes a cut operation, the user agent must act as if the user had invoked a
  copy operation (see the previous section), followed, if the copy was completed successfully, by <a
  href="#contenteditable-delete">a selection delete operation</a>.</p>

  <p>The events involved in this process are the <code data-x="event-dragstart">dragstart</code>,
  <code data-x="event-drag">drag</code>, and <code data-x="event-dragend">dragend</code> events.</p>


  <h5>Paste from clipboard</h5>

  <p>When the user invokes a clipboard paste operation, the user agent must act as if the user had
  invoked a drag on a hypothetical application representing the clipboard, setting the data
  associated with the drag as the content on the clipboard (in whatever formats are available).</p>

  <p>Then, the user agent must act as if the user had indicated (as the <span>immediate user
  selection</span>) the element with the keyboard focus, and then ended the drag-and-drop operation
  without canceling it.</p>

  <p>The events involved in this process are the <code data-x="event-dragenter">dragenter</code>,
  <code data-x="event-dragover">dragover</code>, <code data-x="event-dragexit">dragexit</code>, <code
  data-x="event-dragleave">dragleave</code>, and <code data-x="event-drop">drop</code> events.</p>


  <h5>Paste from selection</h5>

  <p>When the user invokes a selection paste operation, the user agent must act as if the user had
  invoked a drag on the current selection, then indicated (as the <span>immediate user
  selection</span>) the element with the keyboard focus, and then ended the drag-and-drop operation
  without canceling it.</p>

  <p>All the drag-and-drop events can be involved in this process.</p>

  </div>
-->


<!--ADD-TOPIC:Security-->
  <div class="impl">

  <h4 id="security-risks-in-the-drag-and-drop-model"><span class="secno">7.7.9 </span>Security risks in the drag-and-drop model</h4>

  <p>User agents must not make the data added to the <code><a href="editing.html#datatransfer">DataTransfer</a></code> object during the
  <code data-anolis-xref="event-dragstart"><a href="editing.html#event-dragstart">dragstart</a></code> event available to scripts until the <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> event, because otherwise, if a user were to drag sensitive
  information from one document to a second document, crossing a hostile third document in the
  process, the hostile document could intercept the data.</p>

  <p>For the same reason, user agents must consider a drop to be successful only if the user
  specifically ended the drag operation — if any scripts end the drag operation, it must be
  considered unsuccessful (canceled) and the <code data-anolis-xref="event-drop"><a href="editing.html#event-drop">drop</a></code> event must not be
  fired.</p>

  <p>User agents should take care to not start drag-and-drop operations in response to script
  actions. For example, in a mouse-and-window environment, if a script moves a window while the user
  has his mouse button depressed, the UA would not consider that to start a drag. This is important
  because otherwise UAs could cause data to be dragged from sensitive sources and dropped into
  hostile documents without the user's consent.</p>

  <p>User agents should filter potentially active (scripted) content (e.g. HTML) when it is dragged
  and when it is dropped, using a whitelist of known-safe features. Similarly, <a data-anolis-xref="relative
  URL" href="infrastructure.html#relative-url">relative URLs</a> should be turned into absolute URLs to avoid references changing in
  unexpected ways. This specification does not specify how this is performed.</p>

  <div class="example">

   <p>Consider a hostile page providing some content and getting the user to select and drag and
   drop (or indeed, copy and paste) that content to a victim page's <code data-anolis-xref="attr-contenteditable"><a href="editing.html#attr-contenteditable">contenteditable</a></code> region. If the browser does not ensure that
   only safe content is dragged, potentially unsafe content such as scripts and event handlers in
   the selection, once dropped (or pasted) into the victim site, get the privileges of the victim
   site. This would thus enable a cross-site scripting attack.</p>

  </div>

  </div>
<!--REMOVE-TOPIC:Security-->

<!--TOPIC:HTML Syntax and Parsing-->

  